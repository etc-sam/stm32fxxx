<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STM32F103_IMU6050App: i2c/i2c-std.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">STM32F103_IMU6050App<span id="projectnumber">&#160;V1.0</span>
   </div>
   <div id="projectbrief">README.md</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('i2c-std_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">i2c-std.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="init_8h_source.html">init.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for i2c-std.c:</div>
<div class="dyncontent">
<div class="center"><img src="i2c-std_8c__incl.png" border="0" usemap="#ai2c_2i2c-std_8c" alt=""/></div>
</div>
</div>
<p><a href="i2c-std_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af1e961a5d80b477de6216bae4fd1a13c"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#af1e961a5d80b477de6216bae4fd1a13c">i2c_ready_std</a> (I2C_TypeDef *I2CX)</td></tr>
<tr class="memdesc:af1e961a5d80b477de6216bae4fd1a13c"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="i2c-std_8c.html">i2c-std.c</a>  <br /></td></tr>
<tr class="separator:af1e961a5d80b477de6216bae4fd1a13c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85ef801a46f276dfe5d33dc99ae73488"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#a85ef801a46f276dfe5d33dc99ae73488">i2c_wait_start_event_std</a> (I2C_TypeDef *I2CX)</td></tr>
<tr class="memdesc:a85ef801a46f276dfe5d33dc99ae73488"><td class="mdescLeft">&#160;</td><td class="mdescRight">wait until I2C bus is Idle BUSY=0  <br /></td></tr>
<tr class="separator:a85ef801a46f276dfe5d33dc99ae73488"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2c67f3e11cf30f0a8ca085d89fa0bd1"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#af2c67f3e11cf30f0a8ca085d89fa0bd1">i2c_wait_stop_event_std</a> (I2C_TypeDef *I2CX)</td></tr>
<tr class="memdesc:af2c67f3e11cf30f0a8ca085d89fa0bd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">wait start condition is complete SB=1  <br /></td></tr>
<tr class="separator:af2c67f3e11cf30f0a8ca085d89fa0bd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab51a83fd8a35bbe5e610be751cc773a4"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#ab51a83fd8a35bbe5e610be751cc773a4">i2c_wait_7bit_slave_address_wr_std</a> (I2C_TypeDef *I2CX)</td></tr>
<tr class="memdesc:ab51a83fd8a35bbe5e610be751cc773a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">wait stop condition is complete STOPF=1  <br /></td></tr>
<tr class="separator:ab51a83fd8a35bbe5e610be751cc773a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ec15e339f7c57d8bc30c5ed2c2722e7"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#a5ec15e339f7c57d8bc30c5ed2c2722e7">i2c_wait_7bit_slave_address_rd_std</a> (I2C_TypeDef *I2CX)</td></tr>
<tr class="memdesc:a5ec15e339f7c57d8bc30c5ed2c2722e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">wait the slave address acknowledge Master_Write  <br /></td></tr>
<tr class="separator:a5ec15e339f7c57d8bc30c5ed2c2722e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09766e33b0b082d13065b3e03e2bb6d3"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#a09766e33b0b082d13065b3e03e2bb6d3">i2c_wait_write_byte_txe_std</a> (I2C_TypeDef *I2CX)</td></tr>
<tr class="memdesc:a09766e33b0b082d13065b3e03e2bb6d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">wait the slave address acknowledge Master_Read  <br /></td></tr>
<tr class="separator:a09766e33b0b082d13065b3e03e2bb6d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61e492ed3801f4840acd13e83240afcb"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#a61e492ed3801f4840acd13e83240afcb">i2c_wait_write_byte_btf_std</a> (I2C_TypeDef *I2CX)</td></tr>
<tr class="memdesc:a61e492ed3801f4840acd13e83240afcb"><td class="mdescLeft">&#160;</td><td class="mdescRight">wait the complete of current byte transmition (MASTER-write)  <br /></td></tr>
<tr class="separator:a61e492ed3801f4840acd13e83240afcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1614e652c676951bc5a26e5d070ace7b"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#a1614e652c676951bc5a26e5d070ace7b">i2c_wait_read_byte_rxne_std</a> (I2C_TypeDef *I2CX)</td></tr>
<tr class="memdesc:a1614e652c676951bc5a26e5d070ace7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">wait the complete of current byte transmition (MASTER-write)  <br /></td></tr>
<tr class="separator:a1614e652c676951bc5a26e5d070ace7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa44ef3d7bb87a805a912b65fdd93e960"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#aa44ef3d7bb87a805a912b65fdd93e960">i2c_wait_read_byte_btf_std</a> (I2C_TypeDef *I2CX)</td></tr>
<tr class="memdesc:aa44ef3d7bb87a805a912b65fdd93e960"><td class="mdescLeft">&#160;</td><td class="mdescRight">wait the complete of current byte receiption (MASTER-read) using RXNE  <br /></td></tr>
<tr class="separator:aa44ef3d7bb87a805a912b65fdd93e960"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab94774de700d4b23afd5fdeb2e7bd720"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#ab94774de700d4b23afd5fdeb2e7bd720">i2c_start_std</a> (I2C_TypeDef *I2CX)</td></tr>
<tr class="memdesc:ab94774de700d4b23afd5fdeb2e7bd720"><td class="mdescLeft">&#160;</td><td class="mdescRight">wait the complete of current byte receiption (MASTER-read) using BTF  <br /></td></tr>
<tr class="separator:ab94774de700d4b23afd5fdeb2e7bd720"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a148f10682cf5ebeb939bbed609a54ac9"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#a148f10682cf5ebeb939bbed609a54ac9">i2c_stop_std</a> (I2C_TypeDef *I2CX)</td></tr>
<tr class="memdesc:a148f10682cf5ebeb939bbed609a54ac9"><td class="mdescLeft">&#160;</td><td class="mdescRight">initiate start condition  <br /></td></tr>
<tr class="separator:a148f10682cf5ebeb939bbed609a54ac9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8d46b2367148047111a79daa00a9ca2"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#ad8d46b2367148047111a79daa00a9ca2">i2c_send_7bit_slave_address_wr_std</a> (I2C_TypeDef *I2CX, uint8_t slave_address)</td></tr>
<tr class="memdesc:ad8d46b2367148047111a79daa00a9ca2"><td class="mdescLeft">&#160;</td><td class="mdescRight">initiate stop condition  <br /></td></tr>
<tr class="separator:ad8d46b2367148047111a79daa00a9ca2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dea06de59953fa06db4da2938b4b159"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#a0dea06de59953fa06db4da2938b4b159">i2c_send_7bit_slave_address_rd_std</a> (I2C_TypeDef *I2CX, uint8_t slave_address)</td></tr>
<tr class="memdesc:a0dea06de59953fa06db4da2938b4b159"><td class="mdescLeft">&#160;</td><td class="mdescRight">send a slave with write operation via I2C bus  <br /></td></tr>
<tr class="separator:a0dea06de59953fa06db4da2938b4b159"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a020e948eaa99407ff2ffead770cbe3f2"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#a020e948eaa99407ff2ffead770cbe3f2">i2c_write_byte_std</a> (I2C_TypeDef *I2CX, uint8_t data)</td></tr>
<tr class="memdesc:a020e948eaa99407ff2ffead770cbe3f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">send a slave with read operation via I2C bus  <br /></td></tr>
<tr class="separator:a020e948eaa99407ff2ffead770cbe3f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac853a425783ac34982c6f94cd081013f"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#ac853a425783ac34982c6f94cd081013f">i2c_write_nbyte_std</a> (I2C_TypeDef *I2CX, uint8_t *buf, size_t n)</td></tr>
<tr class="memdesc:ac853a425783ac34982c6f94cd081013f"><td class="mdescLeft">&#160;</td><td class="mdescRight">send a byte via I2C bus  <br /></td></tr>
<tr class="separator:ac853a425783ac34982c6f94cd081013f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5bbd8798c3b5a0a1b72f237ef2b2d82"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#ac5bbd8798c3b5a0a1b72f237ef2b2d82">i2c_read_lastbyte_std</a> (I2C_TypeDef *I2CX, uint8_t *buf)</td></tr>
<tr class="memdesc:ac5bbd8798c3b5a0a1b72f237ef2b2d82"><td class="mdescLeft">&#160;</td><td class="mdescRight">send a n bytes via I2C bus  <br /></td></tr>
<tr class="separator:ac5bbd8798c3b5a0a1b72f237ef2b2d82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7faf3e8c9f72d7e07e7167fbd1d0bdaa"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#a7faf3e8c9f72d7e07e7167fbd1d0bdaa">i2c_read_last2byte_std</a> (I2C_TypeDef *I2CX, uint8_t *buf)</td></tr>
<tr class="separator:a7faf3e8c9f72d7e07e7167fbd1d0bdaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72d50ac236d15d870b94b98d6a83ddf9"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#a72d50ac236d15d870b94b98d6a83ddf9">i2c_read_last3byte_std</a> (I2C_TypeDef *I2CX, uint8_t *buf)</td></tr>
<tr class="separator:a72d50ac236d15d870b94b98d6a83ddf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a290145cca85e8399a2ea442701092de9"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#a290145cca85e8399a2ea442701092de9">i2c_read_nbyte_std</a> (I2C_TypeDef *I2CX, uint8_t *data, uint16_t n)</td></tr>
<tr class="separator:a290145cca85e8399a2ea442701092de9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5679181ba1c4b2ad7471fa4d94d5a22"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#aa5679181ba1c4b2ad7471fa4d94d5a22">i2c_init_std</a> (I2C_TypeDef *I2CX, uint32_t clock_speed, uint16_t ownaddress)</td></tr>
<tr class="separator:aa5679181ba1c4b2ad7471fa4d94d5a22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8257b586d43b7046f5bc18e6b226e36b"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#a8257b586d43b7046f5bc18e6b226e36b">i2c_write_7bit_byte_std</a> (I2C_TypeDef *I2CX, uint8_t slave_address, uint8_t data)</td></tr>
<tr class="separator:a8257b586d43b7046f5bc18e6b226e36b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e6fc14e4ed62373119bf4174fd43707"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#a4e6fc14e4ed62373119bf4174fd43707">i2c_write_7bit_nbyte_std</a> (I2C_TypeDef *I2CX, uint8_t slave_address, uint8_t *buf, size_t n)</td></tr>
<tr class="separator:a4e6fc14e4ed62373119bf4174fd43707"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef3f1abb7de04b52828beba49866c9fd"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#aef3f1abb7de04b52828beba49866c9fd">i2c_read_7bit_byte_std</a> (I2C_TypeDef *I2CX, uint8_t slave_address, uint8_t *data)</td></tr>
<tr class="separator:aef3f1abb7de04b52828beba49866c9fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6af858e7040e5e13b3283670577d2d04"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#a6af858e7040e5e13b3283670577d2d04">i2c_read_7bit_word_std</a> (I2C_TypeDef *I2CX, uint8_t slave_address, uint16_t *data)</td></tr>
<tr class="separator:a6af858e7040e5e13b3283670577d2d04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3b8f8fa197052bed7719b1484479609"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#ab3b8f8fa197052bed7719b1484479609">i2c_read_7bit_nbyte_std</a> (I2C_TypeDef *I2CX, uint8_t slave_address, uint8_t *buf, size_t n)</td></tr>
<tr class="separator:ab3b8f8fa197052bed7719b1484479609"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a527f91d19871a248cda4f434094d5d8e"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#a527f91d19871a248cda4f434094d5d8e">i2c_write_7bit_base_byte_std</a> (I2C_TypeDef *I2CX, uint8_t slave_address, uint8_t base_address, uint8_t data)</td></tr>
<tr class="separator:a527f91d19871a248cda4f434094d5d8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92a337a422e0b3d11c2a7e58cd251653"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#a92a337a422e0b3d11c2a7e58cd251653">i2c_write_7bit_base_nbyte_std</a> (I2C_TypeDef *I2CX, uint8_t slave_address, uint8_t base_address, uint8_t *buf, size_t n)</td></tr>
<tr class="separator:a92a337a422e0b3d11c2a7e58cd251653"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3479c54ed280e5893104367d5236bc0e"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#a3479c54ed280e5893104367d5236bc0e">i2c_read_7bit_base_byte_std</a> (I2C_TypeDef *I2CX, uint8_t slave_address, uint8_t base_address, uint8_t *data)</td></tr>
<tr class="separator:a3479c54ed280e5893104367d5236bc0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76970c927307fda4dfbe02a8fe1c516a"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#a76970c927307fda4dfbe02a8fe1c516a">i2c_read_7bit_base_word_std</a> (I2C_TypeDef *I2CX, uint8_t slave_address, uint8_t base_address, uint16_t *data)</td></tr>
<tr class="separator:a76970c927307fda4dfbe02a8fe1c516a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d78f09998ecb95be6143330bcb221b4"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#a3d78f09998ecb95be6143330bcb221b4">i2c_read_7bit_base_nbyte_std</a> (I2C_TypeDef *I2CX, uint8_t slave_address, uint8_t base_address, uint8_t *buf, size_t n)</td></tr>
<tr class="separator:a3d78f09998ecb95be6143330bcb221b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:afe83ed5d7df372f9dcd44526309ef239"><td class="memItemLeft" align="right" valign="top">volatile uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c-std_8c.html#afe83ed5d7df372f9dcd44526309ef239">I2Cx_Timeout</a> =<a class="el" href="i2c-std_8h.html#ab0176c4da537dd1a02b4828483da1e0e">I2C_MAX_BUSY_TIME</a></td></tr>
<tr class="separator:afe83ed5d7df372f9dcd44526309ef239"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="aa5679181ba1c4b2ad7471fa4d94d5a22" name="aa5679181ba1c4b2ad7471fa4d94d5a22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5679181ba1c4b2ad7471fa4d94d5a22">&#9670;&#160;</a></span>i2c_init_std()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void i2c_init_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>clock_speed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>ownaddress</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00881">881</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  882</span>{</div>
<div class="line"><span class="lineno">  883</span>    GPIO_InitTypeDef _gpio_init_struct;</div>
<div class="line"><span class="lineno">  884</span>    I2C_InitTypeDef _i2c_init_struct;</div>
<div class="line"><span class="lineno">  885</span>  </div>
<div class="line"><span class="lineno">  886</span> <span class="comment">/*1. Enable the Clock  the AFIO/GPIO Modules using RCC_APB2PeriphClockCmd*/</span></div>
<div class="line"><span class="lineno">  887</span>    RCC_APB2PeriphClockCmd(RCC_APB2Periph_AFIO| RCC_APB2Periph_GPIOB,ENABLE);</div>
<div class="line"><span class="lineno">  888</span>    </div>
<div class="line"><span class="lineno">  889</span> </div>
<div class="line"><span class="lineno">  890</span> <span class="comment">/* 1.,2. Enable the Clock  the I2Cx Modules  and its GPIO pins mode */</span></div>
<div class="line"><span class="lineno">  891</span>    <span class="keywordflow">if</span>(I2CX==I2C1)  </div>
<div class="line"><span class="lineno">  892</span>    {</div>
<div class="line"><span class="lineno">  893</span>    <span class="comment">/*Enable the Clock  the AFIO/GPIO Modules using RCC_APB2PeriphClockCmd*/</span></div>
<div class="line"><span class="lineno">  894</span>     RCC_APB1PeriphClockCmd(RCC_APB1Periph_I2C1,ENABLE);</div>
<div class="line"><span class="lineno">  895</span>    <span class="comment">/* Configure the pins required by the Module (AFIO_OUT or INPUT, ANALOG...) &amp; remap incase of requirement */</span></div>
<div class="line"><span class="lineno">  896</span>      GPIO_StructInit((GPIO_InitTypeDef*)&amp; _gpio_init_struct);      </div>
<div class="line"><span class="lineno">  897</span>      <span class="comment">// I2C1_SCL=PB6,I2C1_SDA=PB7</span></div>
<div class="line"><span class="lineno">  898</span>     _gpio_init_struct.GPIO_Pin=GPIO_Pin_6 | GPIO_Pin_7;</div>
<div class="line"><span class="lineno">  899</span>     _gpio_init_struct.GPIO_Speed=GPIO_Speed_50MHz;</div>
<div class="line"><span class="lineno">  900</span>     _gpio_init_struct.GPIO_Mode=GPIO_Mode_AF_OD;</div>
<div class="line"><span class="lineno">  901</span>      GPIO_Init(GPIOB,&amp;_gpio_init_struct);</div>
<div class="line"><span class="lineno">  902</span> </div>
<div class="line"><span class="lineno">  903</span>    <span class="comment">/* I2C1 Hardware reset/set of the module */</span></div>
<div class="line"><span class="lineno">  904</span>     RCC_APB1PeriphResetCmd(RCC_APB1Periph_I2C1,ENABLE);</div>
<div class="line"><span class="lineno">  905</span>     RCC_APB1PeriphResetCmd(RCC_APB1Periph_I2C1,DISABLE);</div>
<div class="line"><span class="lineno">  906</span>    }</div>
<div class="line"><span class="lineno">  907</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  908</span>    { <span class="comment">//I2C2</span></div>
<div class="line"><span class="lineno">  909</span>            <span class="comment">/*Enable the Clock  the AFIO/GPIO Modules using RCC_APB2PeriphClockCmd*/</span></div>
<div class="line"><span class="lineno">  910</span>     RCC_APB1PeriphClockCmd(RCC_APB1Periph_I2C2,ENABLE);</div>
<div class="line"><span class="lineno">  911</span>    <span class="comment">/* Configure the pins required by the Module (AFIO_OUT or INPUT, ANALOG...) &amp; remap incase of requirement */</span></div>
<div class="line"><span class="lineno">  912</span>      GPIO_StructInit((GPIO_InitTypeDef*)&amp; _gpio_init_struct);      </div>
<div class="line"><span class="lineno">  913</span>      <span class="comment">// I2C2_SCL=PB10,I2C2_SDA=PB11</span></div>
<div class="line"><span class="lineno">  914</span>     _gpio_init_struct.GPIO_Pin=GPIO_Pin_10 | GPIO_Pin_11;</div>
<div class="line"><span class="lineno">  915</span>     _gpio_init_struct.GPIO_Speed=GPIO_Speed_50MHz;</div>
<div class="line"><span class="lineno">  916</span>     _gpio_init_struct.GPIO_Mode=GPIO_Mode_AF_OD;</div>
<div class="line"><span class="lineno">  917</span>      GPIO_Init(GPIOB,&amp;_gpio_init_struct);</div>
<div class="line"><span class="lineno">  918</span> </div>
<div class="line"><span class="lineno">  919</span>    <span class="comment">/* I2C2 Hardware reset/set of the module */</span></div>
<div class="line"><span class="lineno">  920</span>     RCC_APB1PeriphResetCmd(RCC_APB1Periph_I2C2,ENABLE);</div>
<div class="line"><span class="lineno">  921</span>     RCC_APB1PeriphResetCmd(RCC_APB1Periph_I2C2,DISABLE);</div>
<div class="line"><span class="lineno">  922</span>    }</div>
<div class="line"><span class="lineno">  923</span>  <span class="comment">/* 3. Configure the peripheral hardware interrupt @ level of  NVIC  link to IRQ and set priority */</span></div>
<div class="line"><span class="lineno">  924</span>  <span class="comment">/*   NVIC_InitTypeDef NVIC_InitStruct;</span></div>
<div class="line"><span class="lineno">  925</span><span class="comment">     NVIC_InitStruct.NVIC_IRQChannel=I2C1_EV_IRQn;</span></div>
<div class="line"><span class="lineno">  926</span><span class="comment">     NVIC_InitStruct.NVIC_IRQChannelPreemptionPriority=0;</span></div>
<div class="line"><span class="lineno">  927</span><span class="comment">     NVIC_InitStruct.NVIC_IRQChannelSubPriority=9;</span></div>
<div class="line"><span class="lineno">  928</span><span class="comment">     NVIC_InitStruct.NVIC_IRQChannelCmd=ENABLE;</span></div>
<div class="line"><span class="lineno">  929</span><span class="comment">     NVIC_Init((NVIC_InitTypeDef*) &amp;NVIC_InitStruct);</span></div>
<div class="line"><span class="lineno">  930</span><span class="comment">  */</span></div>
<div class="line"><span class="lineno">  931</span><span class="comment">/* 4.  the peripheral hardware  of the I2C */</span></div>
<div class="line"><span class="lineno">  932</span>    I2C_StructInit((I2C_InitTypeDef *)&amp; _i2c_init_struct);</div>
<div class="line"><span class="lineno">  933</span>    _i2c_init_struct.I2C_Mode=I2C_Mode_I2C ;</div>
<div class="line"><span class="lineno">  934</span>    _i2c_init_struct.I2C_DutyCycle=I2C_DutyCycle_2;</div>
<div class="line"><span class="lineno">  935</span>    _i2c_init_struct.I2C_Ack=I2C_Ack_Enable;</div>
<div class="line"><span class="lineno">  936</span>    _i2c_init_struct.I2C_AcknowledgedAddress=I2C_AcknowledgedAddress_7bit ;</div>
<div class="line"><span class="lineno">  937</span>    _i2c_init_struct. I2C_OwnAddress1=ownaddress;</div>
<div class="line"><span class="lineno">  938</span>    _i2c_init_struct.I2C_ClockSpeed=clock_speed;</div>
<div class="line"><span class="lineno">  939</span>    <span class="comment">// reset the I2C Module</span></div>
<div class="line"><span class="lineno">  940</span>    I2CX-&gt;CR1|=I2C_CR1_SWRST;</div>
<div class="line"><span class="lineno">  941</span>    I2CX-&gt;CR1&amp;=~I2C_CR1_SWRST;</div>
<div class="line"><span class="lineno">  942</span> </div>
<div class="line"><span class="lineno">  943</span>    I2C_Init((I2C_TypeDef*)I2CX,(I2C_InitTypeDef *)&amp; _i2c_init_struct);</div>
<div class="line"><span class="lineno">  944</span>    <span class="comment">//I2CX-&gt;TRISE=37;</span></div>
<div class="line"><span class="lineno">  945</span>  <span class="comment">/* 5. Configure the peripheral interrupt @ level of the peripheral or DMA */</span></div>
<div class="line"><span class="lineno">  946</span>    <span class="comment">//I2C_ITConfig(I2C1, I2C_IT_EVT| I2C_IT_EVT,ENABLE);</span></div>
<div class="line"><span class="lineno">  947</span> </div>
<div class="line"><span class="lineno">  948</span>  <span class="comment">/* 6. Enable the peripheral Module */</span></div>
<div class="line"><span class="lineno">  949</span>    <span class="comment">//I2C_Cmd((I2C_TypeDef*)I2CX,ENABLE);</span></div>
<div class="line"><span class="lineno">  950</span>    I2CX-&gt;CR1|=I2C_CR1_PE;</div>
<div class="line"><span class="lineno">  951</span> </div>
<div class="line"><span class="lineno">  952</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="system-task_8c_source.html#l00089">mpu6050_task()</a>, and <a class="el" href="system_8c_source.html#l00033">system_init()</a>.</p>

</div>
</div>
<a id="a3479c54ed280e5893104367d5236bc0e" name="a3479c54ed280e5893104367d5236bc0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3479c54ed280e5893104367d5236bc0e">&#9670;&#160;</a></span>i2c_read_7bit_base_byte_std()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_read_7bit_base_byte_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slave_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>base_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l01157">1157</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1158</span>{</div>
<div class="line"><span class="lineno"> 1159</span>   </div>
<div class="line"><span class="lineno"> 1160</span>  uint8_t error=0;</div>
<div class="line"><span class="lineno"> 1161</span>   error=<a class="code hl_function" href="i2c-std_8c.html#a3d78f09998ecb95be6143330bcb221b4">i2c_read_7bit_base_nbyte_std</a>(I2CX,slave_address,base_address,(uint8_t *)data, 1);</div>
<div class="line"><span class="lineno"> 1162</span>   <span class="comment">//uart_print(USART1,&quot;RX DATA:&quot;);</span></div>
<div class="line"><span class="lineno"> 1163</span>   <span class="comment">//uart_print_integer(USART1,*data,16);</span></div>
<div class="line"><span class="lineno"> 1164</span>   <span class="comment">//uart_print(USART1,&quot;\r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1165</span>  <span class="keywordflow">if</span>(error!=<a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>)</div>
<div class="line"><span class="lineno"> 1166</span>   <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1167</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;</div>
<div class="line"><span class="lineno"> 1168</span>  </div>
<div class="line"><span class="lineno"> 1169</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1170</span><span class="comment">  // get the error of the any sub operation where a non-zero value indicate an error </span></div>
<div class="line"><span class="lineno"> 1171</span><span class="comment">  uint8_t error=0; </span></div>
<div class="line"><span class="lineno"> 1172</span><span class="comment"> //wait check that the I2c module is not busy</span></div>
<div class="line"><span class="lineno"> 1173</span><span class="comment">    uart_print(USART1,&quot;\nRX_BuSY ...\r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1174</span><span class="comment">    error=i2c_ready_std(I2CX);</span></div>
<div class="line"><span class="lineno"> 1175</span><span class="comment">    if(error)//(error=i2c_ready_std(I2CX))) </span></div>
<div class="line"><span class="lineno"> 1176</span><span class="comment">      return error;</span></div>
<div class="line"><span class="lineno"> 1177</span><span class="comment"> </span></div>
<div class="line"><span class="lineno"> 1178</span><span class="comment">  // send the start condition </span></div>
<div class="line"><span class="lineno"> 1179</span><span class="comment">//    uart_print(USART1,&quot;start condition:&quot;);</span></div>
<div class="line"><span class="lineno"> 1180</span><span class="comment">    uart_print(USART1,&quot;RX_SB ...\r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1181</span><span class="comment">    error=i2c_start_std(I2CX);</span></div>
<div class="line"><span class="lineno"> 1182</span><span class="comment">    if(error)//(error=i2c_start_std(I2CX)))</span></div>
<div class="line"><span class="lineno"> 1183</span><span class="comment">        return error;</span></div>
<div class="line"><span class="lineno"> 1184</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1185</span><span class="comment">    uart_print(USART1,&quot;RX_SLAVE_ADDR ...\r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1186</span><span class="comment">    //EV5: send the slave address with write operation master transmit </span></div>
<div class="line"><span class="lineno"> 1187</span><span class="comment">    error=i2c_send_7bit_slave_address_wr_std(I2CX,slave_address);</span></div>
<div class="line"><span class="lineno"> 1188</span><span class="comment">    if(error)//(error=i2c_send_7bit_slave_address_wr_std(I2CX,slave_address)))</span></div>
<div class="line"><span class="lineno"> 1189</span><span class="comment">        return error;</span></div>
<div class="line"><span class="lineno"> 1190</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1191</span><span class="comment">//    uart_print(USART1,&quot;REG:&quot;);</span></div>
<div class="line"><span class="lineno"> 1192</span><span class="comment">    uart_print(USART1,&quot;RX_REG_DATA ...\r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1193</span><span class="comment">    //Ev6: send the base byte</span></div>
<div class="line"><span class="lineno"> 1194</span><span class="comment">    error=i2c_write_byte_std(I2CX,base_address);</span></div>
<div class="line"><span class="lineno"> 1195</span><span class="comment">    if(error)//(error=i2c_write_byte_std(I2CX,base_address))) </span></div>
<div class="line"><span class="lineno"> 1196</span><span class="comment">      return error;</span></div>
<div class="line"><span class="lineno"> 1197</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1198</span><span class="comment">  // send the repeat start condition </span></div>
<div class="line"><span class="lineno"> 1199</span><span class="comment">    uart_print(USART1,&quot;repeat start....\r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1200</span><span class="comment">    error=i2c_start_std(I2CX);</span></div>
<div class="line"><span class="lineno"> 1201</span><span class="comment">    if(error)//(error=i2c_start_std(I2CX)))</span></div>
<div class="line"><span class="lineno"> 1202</span><span class="comment">        return error;</span></div>
<div class="line"><span class="lineno"> 1203</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1204</span><span class="comment"> // Enable Acknowledgment , clear POS flag</span></div>
<div class="line"><span class="lineno"> 1205</span><span class="comment">    I2C_AcknowledgeConfig(I2CX , ENABLE);</span></div>
<div class="line"><span class="lineno"> 1206</span><span class="comment">    I2C_NACKPositionConfig(I2CX , I2C_NACKPosition_Current);</span></div>
<div class="line"><span class="lineno"> 1207</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1208</span><span class="comment"> //EV5: send the slave address with read operation master transmit </span></div>
<div class="line"><span class="lineno"> 1209</span><span class="comment">    uart_print(USART1,&quot;RX_ Slave RD: \r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1210</span><span class="comment">    error=i2c_send_7bit_slave_address_rd_std(I2CX,slave_address);</span></div>
<div class="line"><span class="lineno"> 1211</span><span class="comment">    if(error)//(error=i2c_send_7bit_slave_address_rd_std(I2CX,slave_address)))</span></div>
<div class="line"><span class="lineno"> 1212</span><span class="comment">      return error;</span></div>
<div class="line"><span class="lineno"> 1213</span><span class="comment">     (void)I2CX-&gt;SR1;</span></div>
<div class="line"><span class="lineno"> 1214</span><span class="comment">     (void)I2CX-&gt;SR2;</span></div>
<div class="line"><span class="lineno"> 1215</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1216</span><span class="comment">    uart_print(USART1,&quot;RX_DATA:&quot;);</span></div>
<div class="line"><span class="lineno"> 1217</span><span class="comment">    error=i2c_read_lastbyte_std(I2CX,data);</span></div>
<div class="line"><span class="lineno"> 1218</span><span class="comment">    uart_print_integer(USART1,*data,16);</span></div>
<div class="line"><span class="lineno"> 1219</span><span class="comment">    uart_print(USART1,&quot;\r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1220</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1221</span><span class="comment">   if(error)//(error=i2c_read_lastbyte_std(I2CX,data)))</span></div>
<div class="line"><span class="lineno"> 1222</span><span class="comment">    return error;    </span></div>
<div class="line"><span class="lineno"> 1223</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1224</span><span class="comment">  // generate the stop condition : note stop generation is done implicitly by the  </span></div>
<div class="line"><span class="lineno"> 1225</span><span class="comment">    uart_print(USART1,&quot;RX_STOP :\r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1226</span><span class="comment">    error=i2c_stop_std(I2CX);</span></div>
<div class="line"><span class="lineno"> 1227</span><span class="comment">    if(error)//(error=i2c_stop_std(I2CX)))// if((error=i2c_wait_stop_event_std(I2CX)))</span></div>
<div class="line"><span class="lineno"> 1228</span><span class="comment">      return error;</span></div>
<div class="line"><span class="lineno"> 1229</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1230</span><span class="comment">  // all operation has succeeded no error to return </span></div>
<div class="line"><span class="lineno"> 1231</span><span class="comment">    return I2C_OK;</span></div>
<div class="line"><span class="lineno"> 1232</span><span class="comment">    */</span></div>
<div class="line"><span class="lineno"> 1233</span>}</div>
<div class="ttc" id="ai2c-std_8c_html_a3d78f09998ecb95be6143330bcb221b4"><div class="ttname"><a href="i2c-std_8c.html#a3d78f09998ecb95be6143330bcb221b4">i2c_read_7bit_base_nbyte_std</a></div><div class="ttdeci">uint8_t i2c_read_7bit_base_nbyte_std(I2C_TypeDef *I2CX, uint8_t slave_address, uint8_t base_address, uint8_t *buf, size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8c_source.html#l01288">i2c-std.c:1288</a></div></div>
<div class="ttc" id="ai2c-std_8h_html_ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a"><div class="ttname"><a href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a></div><div class="ttdeci">@ I2C_OK</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8h_source.html#l00060">i2c-std.h:60</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, and <a class="el" href="i2c-std_8c_source.html#l01288">i2c_read_7bit_base_nbyte_std()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mpu6050_8c_source.html#l00514">mpu6050_enableCycle()</a>, <a class="el" href="mpu6050_8c_source.html#l00347">mpu6050_EnableInterrupts()</a>, <a class="el" href="mpu6050_8c_source.html#l00502">mpu6050_enableSleep()</a>, <a class="el" href="mpu6050_8c_source.html#l00768">mpu6050_get_hpf()</a>, <a class="el" href="mpu6050_8c_source.html#l00757">mpu6050_get_lpf()</a>, <a class="el" href="mpu6050_8c_source.html#l00779">mpu6050_getAccelRange()</a>, <a class="el" href="mpu6050_8c_source.html#l00718">mpu6050_getClock()</a>, <a class="el" href="mpu6050_8c_source.html#l00735">mpu6050_getCycleRate()</a>, <a class="el" href="mpu6050_8c_source.html#l00746">mpu6050_getFsyncSampleOutput()</a>, <a class="el" href="mpu6050_8c_source.html#l00791">mpu6050_getGyroRange()</a>, <a class="el" href="mpu6050_8c_source.html#l00382">mpu6050_read_Interrupts()</a>, <a class="el" href="mpu6050_8c_source.html#l00707">mpu6050_read_reg()</a>, <a class="el" href="mpu6050_8c_source.html#l00572">mpu6050_set_hpf()</a>, <a class="el" href="mpu6050_8c_source.html#l00544">mpu6050_set_lpf()</a>, <a class="el" href="mpu6050_8c_source.html#l00676">mpu6050_setAccelerometerStandby()</a>, <a class="el" href="mpu6050_8c_source.html#l00444">mpu6050_setAccelRange()</a>, <a class="el" href="mpu6050_8c_source.html#l00490">mpu6050_setCycleRate()</a>, <a class="el" href="mpu6050_8c_source.html#l00412">mpu6050_setGyroRange()</a>, <a class="el" href="mpu6050_8c_source.html#l00663">mpu6050_setGyroStandby()</a>, <a class="el" href="mpu6050_8c_source.html#l00526">mpu6050_setI2CBypass()</a>, <a class="el" href="mpu6050_8c_source.html#l00689">mpu6050_setTemperatureStandby()</a>, and <a class="el" href="system-task_8c_source.html#l00089">mpu6050_task()</a>.</p>

</div>
</div>
<a id="a3d78f09998ecb95be6143330bcb221b4" name="a3d78f09998ecb95be6143330bcb221b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d78f09998ecb95be6143330bcb221b4">&#9670;&#160;</a></span>i2c_read_7bit_base_nbyte_std()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_read_7bit_base_nbyte_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slave_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>base_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l01288">1288</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1289</span>{</div>
<div class="line"><span class="lineno"> 1290</span>  <span class="comment">// get the error of the any sub operation where a non-zero value indicate an error </span></div>
<div class="line"><span class="lineno"> 1291</span>  uint8_t error=0; </div>
<div class="line"><span class="lineno"> 1292</span> </div>
<div class="line"><span class="lineno"> 1293</span> <span class="comment">//wait check that the I2c module is not busy</span></div>
<div class="line"><span class="lineno"> 1294</span>  <span class="comment">//wait check that the I2c module is not busy</span></div>
<div class="line"><span class="lineno"> 1295</span>    <span class="comment">//uart_print(USART1,&quot;\nRX_BuSY ...\r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1296</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#af1e961a5d80b477de6216bae4fd1a13c">i2c_ready_std</a>(I2CX))) </div>
<div class="line"><span class="lineno"> 1297</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1298</span>    </div>
<div class="line"><span class="lineno"> 1299</span>   <span class="comment">/* Enable I2C peripheral */</span></div>
<div class="line"><span class="lineno"> 1300</span>     <span class="comment">//SET_BIT(I2CX-&gt;CR1, I2C_CR1_PE);               // done</span></div>
<div class="line"><span class="lineno"> 1301</span>   <span class="comment">/* Disable Pos */</span></div>
<div class="line"><span class="lineno"> 1302</span>     <span class="comment">//CLEAR_BIT(I2CX-&gt;CR1, I2C_CR1_POS);            // done</span></div>
<div class="line"><span class="lineno"> 1303</span>   <span class="comment">/* Enable Acknowledge */</span></div>
<div class="line"><span class="lineno"> 1304</span>     <span class="comment">//SET_BIT(I2CX-&gt;CR1, I2C_CR1_ACK);    // done</span></div>
<div class="line"><span class="lineno"> 1305</span>    <span class="comment">/* Generate Start */</span></div>
<div class="line"><span class="lineno"> 1306</span>     <span class="comment">//SET_BIT(I2CX-&gt;CR1, I2C_CR1_START);  // done</span></div>
<div class="line"><span class="lineno"> 1307</span> </div>
<div class="line"><span class="lineno"> 1308</span> </div>
<div class="line"><span class="lineno"> 1309</span>  <span class="comment">// send the start condition </span></div>
<div class="line"><span class="lineno"> 1310</span>    <span class="comment">//uart_print(USART1,&quot;RX_SB ...\r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1311</span>    error=<a class="code hl_function" href="i2c-std_8c.html#ab94774de700d4b23afd5fdeb2e7bd720">i2c_start_std</a>(I2CX);</div>
<div class="line"><span class="lineno"> 1312</span>    <span class="keywordflow">if</span>(error) </div>
<div class="line"><span class="lineno"> 1313</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1314</span> </div>
<div class="line"><span class="lineno"> 1315</span>    <span class="comment">//EV5: send the slave address with write operation master transmit </span></div>
<div class="line"><span class="lineno"> 1316</span>    <span class="comment">//uart_print(USART1,&quot;RX_SLAVE_ADDR_WR ...\r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1317</span>    error=<a class="code hl_function" href="i2c-std_8c.html#ad8d46b2367148047111a79daa00a9ca2">i2c_send_7bit_slave_address_wr_std</a>(I2CX,slave_address);</div>
<div class="line"><span class="lineno"> 1318</span>    <span class="keywordflow">if</span>(error)</div>
<div class="line"><span class="lineno"> 1319</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1320</span> </div>
<div class="line"><span class="lineno"> 1321</span>    <span class="comment">//Ev6: send the base byte</span></div>
<div class="line"><span class="lineno"> 1322</span>    <span class="comment">//uart_print(USART1,&quot;RX_REG_DATA ...\r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1323</span>    error=<a class="code hl_function" href="i2c-std_8c.html#a020e948eaa99407ff2ffead770cbe3f2">i2c_write_byte_std</a>(I2CX,base_address);</div>
<div class="line"><span class="lineno"> 1324</span>    <span class="keywordflow">if</span>(error)</div>
<div class="line"><span class="lineno"> 1325</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1326</span>        </div>
<div class="line"><span class="lineno"> 1327</span>  <span class="comment">// send the repeat start condition </span></div>
<div class="line"><span class="lineno"> 1328</span>    <span class="comment">//uart_print(USART1,&quot;repeat start....\r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1329</span>    error=<a class="code hl_function" href="i2c-std_8c.html#ab94774de700d4b23afd5fdeb2e7bd720">i2c_start_std</a>(I2CX);</div>
<div class="line"><span class="lineno"> 1330</span>    <span class="keywordflow">if</span>(error) </div>
<div class="line"><span class="lineno"> 1331</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1332</span> <span class="comment">// Enable Acknowledgment , clear POS flag</span></div>
<div class="line"><span class="lineno"> 1333</span>     <span class="comment">//I2C_AcknowledgeConfig(I2CX , ENABLE);</span></div>
<div class="line"><span class="lineno"> 1334</span>     <span class="comment">//I2C_NACKPositionConfig(I2CX , I2C_NACKPosition_Current);</span></div>
<div class="line"><span class="lineno"> 1335</span> </div>
<div class="line"><span class="lineno"> 1336</span><span class="comment">//EV5: send the slave address with a read operation master transmit </span></div>
<div class="line"><span class="lineno"> 1337</span>    <span class="comment">//uart_print(USART1,&quot;RX_ SLAVE_ADDR_RD... \r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1338</span>    error=<a class="code hl_function" href="i2c-std_8c.html#a0dea06de59953fa06db4da2938b4b159">i2c_send_7bit_slave_address_rd_std</a>(I2CX,slave_address);</div>
<div class="line"><span class="lineno"> 1339</span>    <span class="keywordflow">if</span>(error)</div>
<div class="line"><span class="lineno"> 1340</span>      <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1341</span><span class="comment">//EV7:     </span></div>
<div class="line"><span class="lineno"> 1342</span>    <span class="comment">//uart_print(USART1,&quot;DATA RD .... \r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1343</span>    error=<a class="code hl_function" href="i2c-std_8c.html#a290145cca85e8399a2ea442701092de9">i2c_read_nbyte_std</a>(I2CX,buf,n);</div>
<div class="line"><span class="lineno"> 1344</span>   <span class="keywordflow">if</span>(error)</div>
<div class="line"><span class="lineno"> 1345</span>    <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1346</span> </div>
<div class="line"><span class="lineno"> 1347</span><span class="comment">// generate the stop condition : note stop generation is done implicitly by the  </span></div>
<div class="line"><span class="lineno"> 1348</span>    <span class="comment">//uart_print(USART1,&quot;Stop Condition: \r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1349</span>   <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#af2c67f3e11cf30f0a8ca085d89fa0bd1">i2c_wait_stop_event_std</a>(I2CX)))</div>
<div class="line"><span class="lineno"> 1350</span>    <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1351</span> </div>
<div class="line"><span class="lineno"> 1352</span>    <span class="comment">// all operation has succeeded no error to return </span></div>
<div class="line"><span class="lineno"> 1353</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;</div>
<div class="line"><span class="lineno"> 1354</span>}</div>
<div class="ttc" id="ai2c-std_8c_html_a020e948eaa99407ff2ffead770cbe3f2"><div class="ttname"><a href="i2c-std_8c.html#a020e948eaa99407ff2ffead770cbe3f2">i2c_write_byte_std</a></div><div class="ttdeci">static uint8_t i2c_write_byte_std(I2C_TypeDef *I2CX, uint8_t data)</div><div class="ttdoc">send a slave with read operation via I2C bus</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8c_source.html#l00653">i2c-std.c:653</a></div></div>
<div class="ttc" id="ai2c-std_8c_html_a0dea06de59953fa06db4da2938b4b159"><div class="ttname"><a href="i2c-std_8c.html#a0dea06de59953fa06db4da2938b4b159">i2c_send_7bit_slave_address_rd_std</a></div><div class="ttdeci">static uint8_t i2c_send_7bit_slave_address_rd_std(I2C_TypeDef *I2CX, uint8_t slave_address)</div><div class="ttdoc">send a slave with write operation via I2C bus</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8c_source.html#l00634">i2c-std.c:634</a></div></div>
<div class="ttc" id="ai2c-std_8c_html_a290145cca85e8399a2ea442701092de9"><div class="ttname"><a href="i2c-std_8c.html#a290145cca85e8399a2ea442701092de9">i2c_read_nbyte_std</a></div><div class="ttdeci">static uint8_t i2c_read_nbyte_std(I2C_TypeDef *I2CX, uint8_t *data, uint16_t n)</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8c_source.html#l00829">i2c-std.c:829</a></div></div>
<div class="ttc" id="ai2c-std_8c_html_ab94774de700d4b23afd5fdeb2e7bd720"><div class="ttname"><a href="i2c-std_8c.html#ab94774de700d4b23afd5fdeb2e7bd720">i2c_start_std</a></div><div class="ttdeci">static uint8_t i2c_start_std(I2C_TypeDef *I2CX)</div><div class="ttdoc">wait the complete of current byte receiption (MASTER-read) using BTF</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8c_source.html#l00564">i2c-std.c:564</a></div></div>
<div class="ttc" id="ai2c-std_8c_html_ad8d46b2367148047111a79daa00a9ca2"><div class="ttname"><a href="i2c-std_8c.html#ad8d46b2367148047111a79daa00a9ca2">i2c_send_7bit_slave_address_wr_std</a></div><div class="ttdeci">static uint8_t i2c_send_7bit_slave_address_wr_std(I2C_TypeDef *I2CX, uint8_t slave_address)</div><div class="ttdoc">initiate stop condition</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8c_source.html#l00602">i2c-std.c:602</a></div></div>
<div class="ttc" id="ai2c-std_8c_html_af1e961a5d80b477de6216bae4fd1a13c"><div class="ttname"><a href="i2c-std_8c.html#af1e961a5d80b477de6216bae4fd1a13c">i2c_ready_std</a></div><div class="ttdeci">static uint8_t i2c_ready_std(I2C_TypeDef *I2CX)</div><div class="ttdoc">i2c-std.c</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8c_source.html#l00077">i2c-std.c:77</a></div></div>
<div class="ttc" id="ai2c-std_8c_html_af2c67f3e11cf30f0a8ca085d89fa0bd1"><div class="ttname"><a href="i2c-std_8c.html#af2c67f3e11cf30f0a8ca085d89fa0bd1">i2c_wait_stop_event_std</a></div><div class="ttdeci">static uint8_t i2c_wait_stop_event_std(I2C_TypeDef *I2CX)</div><div class="ttdoc">wait start condition is complete SB=1</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8c_source.html#l00183">i2c-std.c:183</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, <a class="el" href="i2c-std_8c_source.html#l00829">i2c_read_nbyte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00077">i2c_ready_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00634">i2c_send_7bit_slave_address_rd_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00602">i2c_send_7bit_slave_address_wr_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00564">i2c_start_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00183">i2c_wait_stop_event_std()</a>, and <a class="el" href="i2c-std_8c_source.html#l00653">i2c_write_byte_std()</a>.</p>

<p class="reference">Referenced by <a class="el" href="i2c-std_8c_source.html#l01157">i2c_read_7bit_base_byte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l01235">i2c_read_7bit_base_word_std()</a>, <a class="el" href="mpu6050_8c_source.html#l00242">mpu6050_read_Accelerometer()</a>, <a class="el" href="mpu6050_8c_source.html#l00310">mpu6050_read_All()</a>, <a class="el" href="mpu6050_8c_source.html#l00265">mpu6050_read_Gyroscope()</a>, and <a class="el" href="mpu6050_8c_source.html#l00288">mpu6050_read_Temperature()</a>.</p>

</div>
</div>
<a id="a76970c927307fda4dfbe02a8fe1c516a" name="a76970c927307fda4dfbe02a8fe1c516a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76970c927307fda4dfbe02a8fe1c516a">&#9670;&#160;</a></span>i2c_read_7bit_base_word_std()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_read_7bit_base_word_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slave_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>base_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l01235">1235</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1236</span>{</div>
<div class="line"><span class="lineno"> 1237</span>  uint8_t error=0;</div>
<div class="line"><span class="lineno"> 1238</span>  <a class="code hl_union" href="unionWORD__BYTES.html">WORD_BYTES</a> t;</div>
<div class="line"><span class="lineno"> 1239</span>   t.<a class="code hl_variable" href="unionWORD__BYTES.html#a3e2e433dc7577b2f6e0b57f72306a52a">word</a>=0;</div>
<div class="line"><span class="lineno"> 1240</span>  <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#a3d78f09998ecb95be6143330bcb221b4">i2c_read_7bit_base_nbyte_std</a>(I2CX,slave_address,base_address,(uint8_t *)t.<a class="code hl_variable" href="unionWORD__BYTES.html#a628ea954a44b91735bbd8c2e1ce1268a">bytes</a>, 2)))</div>
<div class="line"><span class="lineno"> 1241</span>    <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1242</span>   *data=t.<a class="code hl_variable" href="unionWORD__BYTES.html#a3e2e433dc7577b2f6e0b57f72306a52a">word</a>;</div>
<div class="line"><span class="lineno"> 1243</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;</div>
<div class="line"><span class="lineno"> 1244</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1245</span><span class="comment">  // get the error of the any sub operation where a non-zero value indicate an error </span></div>
<div class="line"><span class="lineno"> 1246</span><span class="comment">  uint8_t error=0; </span></div>
<div class="line"><span class="lineno"> 1247</span><span class="comment">  uint8_t buf[2]; </span></div>
<div class="line"><span class="lineno"> 1248</span><span class="comment">  </span></div>
<div class="line"><span class="lineno"> 1249</span><span class="comment"> //wait check that the I2c module is not busy</span></div>
<div class="line"><span class="lineno"> 1250</span><span class="comment">    if((error=i2c_ready_std(I2CX))) </span></div>
<div class="line"><span class="lineno"> 1251</span><span class="comment">        return error;</span></div>
<div class="line"><span class="lineno"> 1252</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1253</span><span class="comment">  // send the start condition  (wait for EV5) as the end of start condition</span></div>
<div class="line"><span class="lineno"> 1254</span><span class="comment">    if((error=i2c_start_std(I2CX))) </span></div>
<div class="line"><span class="lineno"> 1255</span><span class="comment">        return error;</span></div>
<div class="line"><span class="lineno"> 1256</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1257</span><span class="comment">    //EV5: send the slave address with write operation master transmit </span></div>
<div class="line"><span class="lineno"> 1258</span><span class="comment">    if((error=i2c_send_7bit_slave_address_wr_std(I2CX,slave_address)))</span></div>
<div class="line"><span class="lineno"> 1259</span><span class="comment">        return error;</span></div>
<div class="line"><span class="lineno"> 1260</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1261</span><span class="comment">    //Ev6: send the base byte</span></div>
<div class="line"><span class="lineno"> 1262</span><span class="comment">    if((error=i2c_write_byte_std(I2CX,base_address))) </span></div>
<div class="line"><span class="lineno"> 1263</span><span class="comment">        return error;</span></div>
<div class="line"><span class="lineno"> 1264</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1265</span><span class="comment">  // send the repeat start condition </span></div>
<div class="line"><span class="lineno"> 1266</span><span class="comment">    if((error=i2c_start_std(I2CX))) </span></div>
<div class="line"><span class="lineno"> 1267</span><span class="comment">        return error;</span></div>
<div class="line"><span class="lineno"> 1268</span><span class="comment"> // Enable Acknowledgment , clear POS flag</span></div>
<div class="line"><span class="lineno"> 1269</span><span class="comment">     I2C_AcknowledgeConfig(I2CX , ENABLE);</span></div>
<div class="line"><span class="lineno"> 1270</span><span class="comment">     I2C_NACKPositionConfig(I2CX, I2C_NACKPosition_Current);</span></div>
<div class="line"><span class="lineno"> 1271</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1272</span><span class="comment">//EV5: send the slave address with read operation master transmit </span></div>
<div class="line"><span class="lineno"> 1273</span><span class="comment">    if((error=i2c_send_7bit_slave_address_rd_std(I2CX,slave_address)))</span></div>
<div class="line"><span class="lineno"> 1274</span><span class="comment">        return error;</span></div>
<div class="line"><span class="lineno"> 1275</span><span class="comment">     </span></div>
<div class="line"><span class="lineno"> 1276</span><span class="comment">   if((error=i2c_read_last2byte_std(I2CX,buf)))</span></div>
<div class="line"><span class="lineno"> 1277</span><span class="comment">    return error;</span></div>
<div class="line"><span class="lineno"> 1278</span><span class="comment">    *data=(uint16_t)(buf[1]&lt;&lt;8 | buf[0]); </span></div>
<div class="line"><span class="lineno"> 1279</span><span class="comment">    // generate the stop condition : note stop generation is done implicitly by the  </span></div>
<div class="line"><span class="lineno"> 1280</span><span class="comment">    if((error=i2c_wait_stop_event_std(I2CX)))</span></div>
<div class="line"><span class="lineno"> 1281</span><span class="comment">        return error;</span></div>
<div class="line"><span class="lineno"> 1282</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1283</span><span class="comment">    // all operation has succeeded no error to return </span></div>
<div class="line"><span class="lineno"> 1284</span><span class="comment">    return I2C_OK;</span></div>
<div class="line"><span class="lineno"> 1285</span><span class="comment">    */</span></div>
<div class="line"><span class="lineno"> 1286</span>}</div>
<div class="ttc" id="aunionWORD__BYTES_html"><div class="ttname"><a href="unionWORD__BYTES.html">WORD_BYTES</a></div><div class="ttdoc">Little-endian format for one word (16bits)</div><div class="ttdef"><b>Definition:</b> <a href="structs_8h_source.html#l00063">structs.h:64</a></div></div>
<div class="ttc" id="aunionWORD__BYTES_html_a3e2e433dc7577b2f6e0b57f72306a52a"><div class="ttname"><a href="unionWORD__BYTES.html#a3e2e433dc7577b2f6e0b57f72306a52a">WORD_BYTES::word</a></div><div class="ttdeci">uint16_t word</div><div class="ttdef"><b>Definition:</b> <a href="structs_8h_source.html#l00065">structs.h:65</a></div></div>
<div class="ttc" id="aunionWORD__BYTES_html_a628ea954a44b91735bbd8c2e1ce1268a"><div class="ttname"><a href="unionWORD__BYTES.html#a628ea954a44b91735bbd8c2e1ce1268a">WORD_BYTES::bytes</a></div><div class="ttdeci">uint8_t bytes[2]</div><div class="ttdef"><b>Definition:</b> <a href="structs_8h_source.html#l00066">structs.h:66</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structs_8h_source.html#l00066">WORD_BYTES::bytes</a>, <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, <a class="el" href="i2c-std_8c_source.html#l01288">i2c_read_7bit_base_nbyte_std()</a>, and <a class="el" href="structs_8h_source.html#l00065">WORD_BYTES::word</a>.</p>

</div>
</div>
<a id="aef3f1abb7de04b52828beba49866c9fd" name="aef3f1abb7de04b52828beba49866c9fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef3f1abb7de04b52828beba49866c9fd">&#9670;&#160;</a></span>i2c_read_7bit_byte_std()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_read_7bit_byte_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slave_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l01018">1018</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1019</span>{</div>
<div class="line"><span class="lineno"> 1020</span>  uint8_t error=0;</div>
<div class="line"><span class="lineno"> 1021</span> </div>
<div class="line"><span class="lineno"> 1022</span>  <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#ab3b8f8fa197052bed7719b1484479609">i2c_read_7bit_nbyte_std</a>(I2CX,slave_address, (uint8_t *)data, 1)))</div>
<div class="line"><span class="lineno"> 1023</span>   <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1024</span> </div>
<div class="line"><span class="lineno"> 1025</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;</div>
<div class="line"><span class="lineno"> 1026</span>}</div>
<div class="ttc" id="ai2c-std_8c_html_ab3b8f8fa197052bed7719b1484479609"><div class="ttname"><a href="i2c-std_8c.html#ab3b8f8fa197052bed7719b1484479609">i2c_read_7bit_nbyte_std</a></div><div class="ttdeci">uint8_t i2c_read_7bit_nbyte_std(I2C_TypeDef *I2CX, uint8_t slave_address, uint8_t *buf, size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8c_source.html#l01039">i2c-std.c:1039</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, and <a class="el" href="i2c-std_8c_source.html#l01039">i2c_read_7bit_nbyte_std()</a>.</p>

</div>
</div>
<a id="ab3b8f8fa197052bed7719b1484479609" name="ab3b8f8fa197052bed7719b1484479609"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3b8f8fa197052bed7719b1484479609">&#9670;&#160;</a></span>i2c_read_7bit_nbyte_std()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_read_7bit_nbyte_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slave_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l01039">1039</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1040</span>{</div>
<div class="line"><span class="lineno"> 1041</span> </div>
<div class="line"><span class="lineno"> 1042</span>  <span class="comment">// get the error of the any sub operation where a non-zero value indicate an error </span></div>
<div class="line"><span class="lineno"> 1043</span>  uint8_t error=0; </div>
<div class="line"><span class="lineno"> 1044</span> <span class="comment">//wait check that the I2c module is not busy</span></div>
<div class="line"><span class="lineno"> 1045</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#af1e961a5d80b477de6216bae4fd1a13c">i2c_ready_std</a>(I2CX)))</div>
<div class="line"><span class="lineno"> 1046</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1047</span> </div>
<div class="line"><span class="lineno"> 1048</span>  <span class="comment">// send the repeat start condition </span></div>
<div class="line"><span class="lineno"> 1049</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#ab94774de700d4b23afd5fdeb2e7bd720">i2c_start_std</a>(I2CX)))</div>
<div class="line"><span class="lineno"> 1050</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1051</span> <span class="comment">// Enable Acknowledgment , clear POS flag</span></div>
<div class="line"><span class="lineno"> 1052</span>     I2C_AcknowledgeConfig(I2CX , ENABLE);</div>
<div class="line"><span class="lineno"> 1053</span>     I2C_NACKPositionConfig(I2CX , I2C_NACKPosition_Current);</div>
<div class="line"><span class="lineno"> 1054</span> </div>
<div class="line"><span class="lineno"> 1055</span><span class="comment">//EV5: send the slave address with a read operation master transmit </span></div>
<div class="line"><span class="lineno"> 1056</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#a0dea06de59953fa06db4da2938b4b159">i2c_send_7bit_slave_address_rd_std</a>(I2CX,slave_address)))</div>
<div class="line"><span class="lineno"> 1057</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1058</span><span class="comment">//EV7:     </span></div>
<div class="line"><span class="lineno"> 1059</span>   <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#a290145cca85e8399a2ea442701092de9">i2c_read_nbyte_std</a>(I2CX,buf,n)))</div>
<div class="line"><span class="lineno"> 1060</span>    <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1061</span> </div>
<div class="line"><span class="lineno"> 1062</span><span class="comment">// generate the stop condition : note stop generation is done implicitly by the  </span></div>
<div class="line"><span class="lineno"> 1063</span>   <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#af2c67f3e11cf30f0a8ca085d89fa0bd1">i2c_wait_stop_event_std</a>(I2CX)))</div>
<div class="line"><span class="lineno"> 1064</span>      <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1065</span> </div>
<div class="line"><span class="lineno"> 1066</span>    <span class="comment">// all operation has succeeded no error to return </span></div>
<div class="line"><span class="lineno"> 1067</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;</div>
<div class="line"><span class="lineno"> 1068</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, <a class="el" href="i2c-std_8c_source.html#l00829">i2c_read_nbyte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00077">i2c_ready_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00634">i2c_send_7bit_slave_address_rd_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00564">i2c_start_std()</a>, and <a class="el" href="i2c-std_8c_source.html#l00183">i2c_wait_stop_event_std()</a>.</p>

<p class="reference">Referenced by <a class="el" href="i2c-std_8c_source.html#l01018">i2c_read_7bit_byte_std()</a>, and <a class="el" href="i2c-std_8c_source.html#l01028">i2c_read_7bit_word_std()</a>.</p>

</div>
</div>
<a id="a6af858e7040e5e13b3283670577d2d04" name="a6af858e7040e5e13b3283670577d2d04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6af858e7040e5e13b3283670577d2d04">&#9670;&#160;</a></span>i2c_read_7bit_word_std()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_read_7bit_word_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slave_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l01028">1028</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1029</span>{</div>
<div class="line"><span class="lineno"> 1030</span>  uint8_t error=0;</div>
<div class="line"><span class="lineno"> 1031</span>  <a class="code hl_union" href="unionWORD__BYTES.html">WORD_BYTES</a> t;</div>
<div class="line"><span class="lineno"> 1032</span>  t.<a class="code hl_variable" href="unionWORD__BYTES.html#a3e2e433dc7577b2f6e0b57f72306a52a">word</a>=0;</div>
<div class="line"><span class="lineno"> 1033</span>  <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#ab3b8f8fa197052bed7719b1484479609">i2c_read_7bit_nbyte_std</a>(I2CX,slave_address, (uint8_t *)t.<a class="code hl_variable" href="unionWORD__BYTES.html#a628ea954a44b91735bbd8c2e1ce1268a">bytes</a>, 2)))</div>
<div class="line"><span class="lineno"> 1034</span>   <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1035</span>  *data=t.<a class="code hl_variable" href="unionWORD__BYTES.html#a3e2e433dc7577b2f6e0b57f72306a52a">word</a>;</div>
<div class="line"><span class="lineno"> 1036</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;</div>
<div class="line"><span class="lineno"> 1037</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structs_8h_source.html#l00066">WORD_BYTES::bytes</a>, <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, <a class="el" href="i2c-std_8c_source.html#l01039">i2c_read_7bit_nbyte_std()</a>, and <a class="el" href="structs_8h_source.html#l00065">WORD_BYTES::word</a>.</p>

</div>
</div>
<a id="a7faf3e8c9f72d7e07e7167fbd1d0bdaa" name="a7faf3e8c9f72d7e07e7167fbd1d0bdaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7faf3e8c9f72d7e07e7167fbd1d0bdaa">&#9670;&#160;</a></span>i2c_read_last2byte_std()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_read_last2byte_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">I2CX</td><td></td></tr>
    <tr><td class="paramname">data</td><td></td></tr>
    <tr><td class="paramname">ack</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t </dd></dl>

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00731">731</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  732</span>{</div>
<div class="line"><span class="lineno">  733</span>  uint8_t error=<a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;</div>
<div class="line"><span class="lineno">  734</span>  <span class="comment">/* Enable Pos */</span></div>
<div class="line"><span class="lineno">  735</span>  <a class="code hl_define" href="group__Exported__macros.html#ga26474f43799fbade9cf300e21dd3a91a">SET_BIT</a>(I2CX-&gt;CR1, I2C_CR1_POS); <span class="comment">//I2CX-&gt;CR1|=I2C_CR1_POS;   //I2C_NACKPositionConfig(I2CX , I2C_NACKPosition_Next);</span></div>
<div class="line"><span class="lineno">  736</span> </div>
<div class="line"><span class="lineno">  737</span>  <span class="comment">/* Disable all active IRQs around ADDR clearing and STOP programming because the EV6_3</span></div>
<div class="line"><span class="lineno">  738</span><span class="comment">      software sequence must complete before the current byte end of transfer */</span></div>
<div class="line"><span class="lineno">  739</span>__disable_irq ();</div>
<div class="line"><span class="lineno">  740</span><span class="comment">// Clear ADDR flag</span></div>
<div class="line"><span class="lineno">  741</span>  <a class="code hl_define" href="i2c-std_8h.html#a22a728f90de94e71843c18f0650f18b3">_I2C_CLEAR_ADDRFLAG</a>(I2CX);    <span class="comment">//(void) I2CX-&gt;SR1;(void) I2CX-&gt;SR2; </span></div>
<div class="line"><span class="lineno">  742</span>  <span class="comment">/* Disable Acknowledge */</span></div>
<div class="line"><span class="lineno">  743</span>  <a class="code hl_define" href="group__Exported__macros.html#ga133aae6fc0d41bffab39ab223a7001de">CLEAR_BIT</a>(I2CX-&gt;CR1,I2C_CR1_ACK); <span class="comment">//I2CX-&gt;CR1&amp;=~I2C_CR1_ACK;//I2C_AcknowledgeConfig(I2CX , DISABLE); // Clear Ack bit</span></div>
<div class="line"><span class="lineno">  744</span>__enable_irq ();</div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span><span class="comment">// EV7_3 -- Wait for BTF , program stop , read data twice</span></div>
<div class="line"><span class="lineno">  747</span>  error=<a class="code hl_function" href="i2c-std_8c.html#aa44ef3d7bb87a805a912b65fdd93e960">i2c_wait_read_byte_btf_std</a>(I2CX);</div>
<div class="line"><span class="lineno">  748</span>  <span class="keywordflow">if</span>(error!=<a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>)</div>
<div class="line"><span class="lineno">  749</span>  <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno">  750</span> </div>
<div class="line"><span class="lineno">  751</span>__disable_irq ();</div>
<div class="line"><span class="lineno">  752</span>  <span class="comment">/* Generate Stop */</span></div>
<div class="line"><span class="lineno">  753</span>  <a class="code hl_define" href="group__Exported__macros.html#ga26474f43799fbade9cf300e21dd3a91a">SET_BIT</a>(I2CX-&gt;CR1,I2C_CR1_STOP); <span class="comment">//I2C_GenerateSTOP(I2CX ,ENABLE);</span></div>
<div class="line"><span class="lineno">  754</span>  <span class="comment">//*buf++ = I2CX-&gt;DR;  </span></div>
<div class="line"><span class="lineno">  755</span>  <span class="comment">/* Read data from DR */</span></div>
<div class="line"><span class="lineno">  756</span>  *buf = I2CX-&gt;DR;</div>
<div class="line"><span class="lineno">  757</span>  <span class="comment">/* Increment Buffer pointer */</span></div>
<div class="line"><span class="lineno">  758</span>  buf++;</div>
<div class="line"><span class="lineno">  759</span> __enable_irq ();</div>
<div class="line"><span class="lineno">  760</span> <span class="comment">/* Read data from DR */</span></div>
<div class="line"><span class="lineno">  761</span>  *buf= I2CX-&gt;DR;</div>
<div class="line"><span class="lineno">  762</span> </div>
<div class="line"><span class="lineno">  763</span> <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;</div>
<div class="line"><span class="lineno">  764</span>}</div>
<div class="ttc" id="agroup__Exported__macros_html_ga133aae6fc0d41bffab39ab223a7001de"><div class="ttname"><a href="group__Exported__macros.html#ga133aae6fc0d41bffab39ab223a7001de">CLEAR_BIT</a></div><div class="ttdeci">#define CLEAR_BIT(REG, BIT)</div><div class="ttdef"><b>Definition:</b> <a href="init-macro_8h_source.html#l00016">init-macro.h:16</a></div></div>
<div class="ttc" id="agroup__Exported__macros_html_ga26474f43799fbade9cf300e21dd3a91a"><div class="ttname"><a href="group__Exported__macros.html#ga26474f43799fbade9cf300e21dd3a91a">SET_BIT</a></div><div class="ttdeci">#define SET_BIT(REG, BIT)</div><div class="ttdef"><b>Definition:</b> <a href="init-macro_8h_source.html#l00014">init-macro.h:14</a></div></div>
<div class="ttc" id="ai2c-std_8c_html_aa44ef3d7bb87a805a912b65fdd93e960"><div class="ttname"><a href="i2c-std_8c.html#aa44ef3d7bb87a805a912b65fdd93e960">i2c_wait_read_byte_btf_std</a></div><div class="ttdeci">static uint8_t i2c_wait_read_byte_btf_std(I2C_TypeDef *I2CX)</div><div class="ttdoc">wait the complete of current byte receiption (MASTER-read) using RXNE</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8c_source.html#l00537">i2c-std.c:537</a></div></div>
<div class="ttc" id="ai2c-std_8h_html_a22a728f90de94e71843c18f0650f18b3"><div class="ttname"><a href="i2c-std_8h.html#a22a728f90de94e71843c18f0650f18b3">_I2C_CLEAR_ADDRFLAG</a></div><div class="ttdeci">#define _I2C_CLEAR_ADDRFLAG(I2Cx)</div><div class="ttdoc">Clears the I2C ADDR pending flag.</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8h_source.html#l00110">i2c-std.h:110</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="i2c-std_8h_source.html#l00110">_I2C_CLEAR_ADDRFLAG</a>, <a class="el" href="init-macro_8h_source.html#l00016">CLEAR_BIT</a>, <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, <a class="el" href="i2c-std_8c_source.html#l00537">i2c_wait_read_byte_btf_std()</a>, and <a class="el" href="init-macro_8h_source.html#l00014">SET_BIT</a>.</p>

<p class="reference">Referenced by <a class="el" href="i2c-std_8c_source.html#l00829">i2c_read_nbyte_std()</a>.</p>

</div>
</div>
<a id="a72d50ac236d15d870b94b98d6a83ddf9" name="a72d50ac236d15d870b94b98d6a83ddf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72d50ac236d15d870b94b98d6a83ddf9">&#9670;&#160;</a></span>i2c_read_last3byte_std()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_read_last3byte_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00766">766</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  767</span> {</div>
<div class="line"><span class="lineno">  768</span>  uint8_t error=0;</div>
<div class="line"><span class="lineno">  769</span>  <span class="keyword">volatile</span> uint32_t Timeout=0xfffff;</div>
<div class="line"><span class="lineno">  770</span>  <span class="comment">// Clear ADDR flag</span></div>
<div class="line"><span class="lineno">  771</span>  <span class="comment">// _I2C_CLEAR_ADDRFLAG(I2CX);//(void) I2CX -&gt;SR1;(void) I2CX -&gt;SR2; </span></div>
<div class="line"><span class="lineno">  772</span>   error=<a class="code hl_function" href="i2c-std_8c.html#aa44ef3d7bb87a805a912b65fdd93e960">i2c_wait_read_byte_btf_std</a>(I2CX);</div>
<div class="line"><span class="lineno">  773</span>   <span class="keywordflow">if</span>(error!=<a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>)</div>
<div class="line"><span class="lineno">  774</span>      <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno">  775</span><span class="comment">// EV7_2 -- Figure 1 has an error , doesn &#39;t read N-2 !</span></div>
<div class="line"><span class="lineno">  776</span>    <span class="comment">/* Disable Acknowledge */</span></div>
<div class="line"><span class="lineno">  777</span>    <a class="code hl_define" href="group__Exported__macros.html#ga133aae6fc0d41bffab39ab223a7001de">CLEAR_BIT</a>(I2CX-&gt;CR1,I2C_CR1_ACK);  <span class="comment">//I2C_AcknowledgeConfig(I2CX , DISABLE); // clear ack bit</span></div>
<div class="line"><span class="lineno">  778</span> </div>
<div class="line"><span class="lineno">  779</span><span class="comment">/*</span></div>
<div class="line"><span class="lineno">  780</span><span class="comment">__disable_irq ();</span></div>
<div class="line"><span class="lineno">  781</span><span class="comment">  *buf++=I2CX-&gt;DR; // receive byte N-2</span></div>
<div class="line"><span class="lineno">  782</span><span class="comment"> // Generate Stop </span></div>
<div class="line"><span class="lineno">  783</span><span class="comment">  SET_BIT(I2CX-&gt;CR1,I2C_CR1_STOP); //I2C_GenerateSTOP(I2CX ,ENABLE); // program stop</span></div>
<div class="line"><span class="lineno">  784</span><span class="comment">__enable_irq ();</span></div>
<div class="line"><span class="lineno">  785</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  786</span><span class="comment">*buf++ = I2CX-&gt;DR;  // receive byte N-1</span></div>
<div class="line"><span class="lineno">  787</span><span class="comment">// wait for byte N</span></div>
<div class="line"><span class="lineno">  788</span><span class="comment">// Receive data EV7</span></div>
<div class="line"><span class="lineno">  789</span><span class="comment">error=i2c_wait_read_byte_rxne_std(I2CX);</span></div>
<div class="line"><span class="lineno">  790</span><span class="comment">  if(error)  // I2C_EVENT_MASTER_BYTE_RECEIVED:: BUSY, MSL and RXNE flags </span></div>
<div class="line"><span class="lineno">  791</span><span class="comment">    return error;</span></div>
<div class="line"><span class="lineno">  792</span><span class="comment"> *buf++ = I2CX-&gt;DR;</span></div>
<div class="line"><span class="lineno">  793</span><span class="comment"> return I2C_OK; </span></div>
<div class="line"><span class="lineno">  794</span><span class="comment"> */</span></div>
<div class="line"><span class="lineno">  795</span> </div>
<div class="line"><span class="lineno">  796</span><span class="comment">/* Disable all active IRQs around ADDR clearing and STOP programming because the EV6_3</span></div>
<div class="line"><span class="lineno">  797</span><span class="comment">             software sequence must complete before the current byte end of transfer */</span></div>
<div class="line"><span class="lineno">  798</span>__disable_irq ();</div>
<div class="line"><span class="lineno">  799</span>  *buf=I2CX-&gt;DR; <span class="comment">// receive byte N-2</span></div>
<div class="line"><span class="lineno">  800</span>   buf++;</div>
<div class="line"><span class="lineno">  801</span>   Timeout=<a class="code hl_define" href="i2c-std_8h.html#a52796b3a6cf92d6b16bf5e2164e65146">I2C_MAX_WAIT_TIME</a> *(SystemCoreClock / 25U / 1000U);</div>
<div class="line"><span class="lineno">  802</span>    <span class="keywordflow">while</span>(<a class="code hl_define" href="basic_8h.html#aa239d38020eac3ff2bea1a5e1c30c5a9">bits_is_clear</a>(I2CX-&gt;SR1,I2C_SR1_BTF))<span class="comment">//bits_is_clear(I2CX-&gt;SR1,I2C_SR1_BTF)) //I2C_GetFlagStatus(I2CX,I2C_FLAG_BTF))</span></div>
<div class="line"><span class="lineno">  803</span>    <span class="keywordflow">if</span>(Timeout--==0)  </div>
<div class="line"><span class="lineno">  804</span>    {</div>
<div class="line"><span class="lineno">  805</span>      __enable_irq();</div>
<div class="line"><span class="lineno">  806</span>      <span class="comment">// set the error then exit ::I2C_RX_RXNE_ERROR</span></div>
<div class="line"><span class="lineno">  807</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a28ee3405ef74e2215500f400dbe80929">I2C_RX_BTF_ERROR</a>;</div>
<div class="line"><span class="lineno">  808</span>    }</div>
<div class="line"><span class="lineno">  809</span> <span class="comment">// Generate Stop </span></div>
<div class="line"><span class="lineno">  810</span>  <a class="code hl_define" href="group__Exported__macros.html#ga26474f43799fbade9cf300e21dd3a91a">SET_BIT</a>(I2CX-&gt;CR1,I2C_CR1_STOP); </div>
<div class="line"><span class="lineno">  811</span>  *buf=I2CX-&gt;DR; <span class="comment">// receive byte N-1</span></div>
<div class="line"><span class="lineno">  812</span>   buf++;</div>
<div class="line"><span class="lineno">  813</span>  <span class="comment">/* Re-enable IRQs */</span>        </div>
<div class="line"><span class="lineno">  814</span>  __enable_irq();</div>
<div class="line"><span class="lineno">  815</span> </div>
<div class="line"><span class="lineno">  816</span>  *buf=I2CX-&gt;DR; <span class="comment">// receive byte N-1</span></div>
<div class="line"><span class="lineno">  817</span>   buf++;</div>
<div class="line"><span class="lineno">  818</span>   <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;</div>
<div class="line"><span class="lineno">  819</span>}</div>
<div class="ttc" id="abasic_8h_html_aa239d38020eac3ff2bea1a5e1c30c5a9"><div class="ttname"><a href="basic_8h.html#aa239d38020eac3ff2bea1a5e1c30c5a9">bits_is_clear</a></div><div class="ttdeci">#define bits_is_clear(data, bits)</div><div class="ttdef"><b>Definition:</b> <a href="basic_8h_source.html#l00055">basic.h:55</a></div></div>
<div class="ttc" id="ai2c-std_8h_html_a52796b3a6cf92d6b16bf5e2164e65146"><div class="ttname"><a href="i2c-std_8h.html#a52796b3a6cf92d6b16bf5e2164e65146">I2C_MAX_WAIT_TIME</a></div><div class="ttdeci">#define I2C_MAX_WAIT_TIME</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8h_source.html#l00027">i2c-std.h:27</a></div></div>
<div class="ttc" id="ai2c-std_8h_html_ac8daa3f8c12741492c20cf528dbb2019a28ee3405ef74e2215500f400dbe80929"><div class="ttname"><a href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a28ee3405ef74e2215500f400dbe80929">I2C_RX_BTF_ERROR</a></div><div class="ttdeci">@ I2C_RX_BTF_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8h_source.html#l00074">i2c-std.h:74</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic_8h_source.html#l00055">bits_is_clear</a>, <a class="el" href="init-macro_8h_source.html#l00016">CLEAR_BIT</a>, <a class="el" href="i2c-std_8h_source.html#l00027">I2C_MAX_WAIT_TIME</a>, <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, <a class="el" href="i2c-std_8h_source.html#l00074">I2C_RX_BTF_ERROR</a>, <a class="el" href="i2c-std_8c_source.html#l00537">i2c_wait_read_byte_btf_std()</a>, and <a class="el" href="init-macro_8h_source.html#l00014">SET_BIT</a>.</p>

<p class="reference">Referenced by <a class="el" href="i2c-std_8c_source.html#l00829">i2c_read_nbyte_std()</a>.</p>

</div>
</div>
<a id="ac5bbd8798c3b5a0a1b72f237ef2b2d82" name="ac5bbd8798c3b5a0a1b72f237ef2b2d82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5bbd8798c3b5a0a1b72f237ef2b2d82">&#9670;&#160;</a></span>i2c_read_lastbyte_std()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_read_lastbyte_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>send a n bytes via I2C bus </p>
<p>EV7_3: BTF = 1, program STOP = 1, read DR twice (Read Data1 and Data2) just after programming the STOP.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">I2CX</td><td></td></tr>
    <tr><td class="paramname">data</td><td></td></tr>
    <tr><td class="paramname">ack</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t </dd></dl>

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00693">693</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  694</span>{</div>
<div class="line"><span class="lineno">  695</span>   uint8_t error=<a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;</div>
<div class="line"><span class="lineno">  696</span>   <span class="comment">// clear POS flag</span></div>
<div class="line"><span class="lineno">  697</span>     <a class="code hl_define" href="group__Exported__macros.html#ga133aae6fc0d41bffab39ab223a7001de">CLEAR_BIT</a>(I2CX-&gt;CR1,I2C_CR1_POS); <span class="comment">//I2C_NACKPositionConfig(I2CX , I2C_NACKPosition_Current);</span></div>
<div class="line"><span class="lineno">  698</span> </div>
<div class="line"><span class="lineno">  699</span>    <span class="comment">/* Disable Acknowledge */</span></div>
<div class="line"><span class="lineno">  700</span>     <a class="code hl_define" href="group__Exported__macros.html#ga133aae6fc0d41bffab39ab223a7001de">CLEAR_BIT</a>(I2CX-&gt;CR1,I2C_CR1_ACK); <span class="comment">//I2C_AcknowledgeConfig(I2CX , DISABLE);</span></div>
<div class="line"><span class="lineno">  701</span> </div>
<div class="line"><span class="lineno">  702</span><span class="comment">// EV6_3 -- must be atomic -- Clear ADDR (by reading SR1 then SR2), generate STOP  </span></div>
<div class="line"><span class="lineno">  703</span>  <span class="comment">/* Disable all active IRQs around ADDR clearing and STOP programming because the EV6_3</span></div>
<div class="line"><span class="lineno">  704</span><span class="comment">    software sequence must complete before the current byte end of transfer */</span></div>
<div class="line"><span class="lineno">  705</span>  __disable_irq ();</div>
<div class="line"><span class="lineno">  706</span>    <a class="code hl_define" href="i2c-std_8h.html#a22a728f90de94e71843c18f0650f18b3">_I2C_CLEAR_ADDRFLAG</a>(I2CX);                <span class="comment">/* Clear ADDR flag */</span> <span class="comment">// (void) I2CX-&gt;SR1; (void) I2CX-&gt;SR2;</span></div>
<div class="line"><span class="lineno">  707</span>     <a class="code hl_define" href="group__Exported__macros.html#ga26474f43799fbade9cf300e21dd3a91a">SET_BIT</a>(I2CX-&gt;CR1,I2C_CR1_STOP);        <span class="comment">/* Generate Stop */</span>  <span class="comment">//I2C_GenerateSTOP(I2CX ,ENABLE);</span></div>
<div class="line"><span class="lineno">  708</span> __enable_irq ();</div>
<div class="line"><span class="lineno">  709</span> </div>
<div class="line"><span class="lineno">  710</span>  <span class="comment">// Receive data EV7</span></div>
<div class="line"><span class="lineno">  711</span>  error=<a class="code hl_function" href="i2c-std_8c.html#a1614e652c676951bc5a26e5d070ace7b">i2c_wait_read_byte_rxne_std</a>(I2CX);</div>
<div class="line"><span class="lineno">  712</span>  <span class="keywordflow">if</span>(error!=<a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>)</div>
<div class="line"><span class="lineno">  713</span>    <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno">  714</span> </div>
<div class="line"><span class="lineno">  715</span>   *data = I2CX-&gt;DR;</div>
<div class="line"><span class="lineno">  716</span>   <span class="comment">//uart_print(USART1,&quot;I2C_DR:&quot;);</span></div>
<div class="line"><span class="lineno">  717</span>   <span class="comment">//uart_print_integer(USART1,*data,16);</span></div>
<div class="line"><span class="lineno">  718</span>   <span class="comment">//uart_print(USART1,&quot;\r\n&quot;);</span></div>
<div class="line"><span class="lineno">  719</span> </div>
<div class="line"><span class="lineno">  720</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;</div>
<div class="line"><span class="lineno">  721</span>}</div>
<div class="ttc" id="ai2c-std_8c_html_a1614e652c676951bc5a26e5d070ace7b"><div class="ttname"><a href="i2c-std_8c.html#a1614e652c676951bc5a26e5d070ace7b">i2c_wait_read_byte_rxne_std</a></div><div class="ttdeci">static uint8_t i2c_wait_read_byte_rxne_std(I2C_TypeDef *I2CX)</div><div class="ttdoc">wait the complete of current byte transmition (MASTER-write)</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8c_source.html#l00497">i2c-std.c:497</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="i2c-std_8h_source.html#l00110">_I2C_CLEAR_ADDRFLAG</a>, <a class="el" href="init-macro_8h_source.html#l00016">CLEAR_BIT</a>, <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, <a class="el" href="i2c-std_8c_source.html#l00497">i2c_wait_read_byte_rxne_std()</a>, and <a class="el" href="init-macro_8h_source.html#l00014">SET_BIT</a>.</p>

<p class="reference">Referenced by <a class="el" href="i2c-std_8c_source.html#l00829">i2c_read_nbyte_std()</a>.</p>

</div>
</div>
<a id="a290145cca85e8399a2ea442701092de9" name="a290145cca85e8399a2ea442701092de9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a290145cca85e8399a2ea442701092de9">&#9670;&#160;</a></span>i2c_read_nbyte_std()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_read_nbyte_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">I2CX</td><td></td></tr>
    <tr><td class="paramname">data</td><td></td></tr>
    <tr><td class="paramname">ack</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t </dd></dl>

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00829">829</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  830</span>{</div>
<div class="line"><span class="lineno">  831</span>    uint8_t error=0;    </div>
<div class="line"><span class="lineno">  832</span>    <span class="keywordflow">if</span>(n==0) </div>
<div class="line"><span class="lineno">  833</span>    {      </div>
<div class="line"><span class="lineno">  834</span>      <span class="comment">/* Clear ADDR flag */</span></div>
<div class="line"><span class="lineno">  835</span>      <a class="code hl_define" href="i2c-std_8h.html#a22a728f90de94e71843c18f0650f18b3">_I2C_CLEAR_ADDRFLAG</a>(I2CX);</div>
<div class="line"><span class="lineno">  836</span> </div>
<div class="line"><span class="lineno">  837</span>      <span class="comment">/* Generate Stop */</span></div>
<div class="line"><span class="lineno">  838</span>      <a class="code hl_define" href="group__Exported__macros.html#ga26474f43799fbade9cf300e21dd3a91a">SET_BIT</a>(I2CX-&gt;CR1, I2C_CR1_STOP);</div>
<div class="line"><span class="lineno">  839</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;</div>
<div class="line"><span class="lineno">  840</span>    }</div>
<div class="line"><span class="lineno">  841</span> </div>
<div class="line"><span class="lineno">  842</span>    <span class="keywordflow">if</span>(n==1) <span class="keywordflow">return</span> <a class="code hl_function" href="i2c-std_8c.html#ac5bbd8798c3b5a0a1b72f237ef2b2d82">i2c_read_lastbyte_std</a>(I2CX,buf);</div>
<div class="line"><span class="lineno">  843</span>    <span class="keywordflow">if</span>(n==2) <span class="keywordflow">return</span> <a class="code hl_function" href="i2c-std_8c.html#a7faf3e8c9f72d7e07e7167fbd1d0bdaa">i2c_read_last2byte_std</a>(I2CX,buf);</div>
<div class="line"><span class="lineno">  844</span>     </div>
<div class="line"><span class="lineno">  845</span>    <span class="comment">// clear POS flag</span></div>
<div class="line"><span class="lineno">  846</span>     <a class="code hl_define" href="group__Exported__macros.html#ga133aae6fc0d41bffab39ab223a7001de">CLEAR_BIT</a>(I2CX-&gt;CR1,I2C_CR1_POS); </div>
<div class="line"><span class="lineno">  847</span>     <span class="comment">/* Enable Acknowledge */</span></div>
<div class="line"><span class="lineno">  848</span>      <a class="code hl_define" href="group__Exported__macros.html#ga26474f43799fbade9cf300e21dd3a91a">SET_BIT</a>(I2CX-&gt;CR1,I2C_CR1_ACK);</div>
<div class="line"><span class="lineno">  849</span>      <span class="comment">/* Clear ADDR flag */</span></div>
<div class="line"><span class="lineno">  850</span>      <a class="code hl_define" href="i2c-std_8h.html#a22a728f90de94e71843c18f0650f18b3">_I2C_CLEAR_ADDRFLAG</a>(I2CX);</div>
<div class="line"><span class="lineno">  851</span> </div>
<div class="line"><span class="lineno">  852</span>    <span class="keywordflow">if</span>(n&gt;3)</div>
<div class="line"><span class="lineno">  853</span>    {</div>
<div class="line"><span class="lineno">  854</span>      <span class="keywordflow">for</span> (uint16_t i = 0; i &lt; n-3; i++) </div>
<div class="line"><span class="lineno">  855</span>       {</div>
<div class="line"><span class="lineno">  856</span>            <span class="comment">// EV7 -- cannot guarantee 1 transfer completion time ,</span></div>
<div class="line"><span class="lineno">  857</span>            <span class="comment">// wait for BTF instead of RXNE</span></div>
<div class="line"><span class="lineno">  858</span>            error=<a class="code hl_function" href="i2c-std_8c.html#a1614e652c676951bc5a26e5d070ace7b">i2c_wait_read_byte_rxne_std</a>(I2CX);</div>
<div class="line"><span class="lineno">  859</span>            <span class="keywordflow">if</span>(error!=<a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>)</div>
<div class="line"><span class="lineno">  860</span>                <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno">  861</span>              buf[i] = I2CX-&gt;DR;</div>
<div class="line"><span class="lineno">  862</span>           <span class="keywordflow">if</span>(<a class="code hl_define" href="basic_8h.html#a793bbd5374ca9d6747044316c4ef9e0e">bits_is_set</a>(I2CX-&gt;SR1,I2C_SR1_BTF))<span class="comment">//__HAL_I2C_GET_FLAG(hi2c, I2C_FLAG_BTF) == SET)</span></div>
<div class="line"><span class="lineno">  863</span>            {</div>
<div class="line"><span class="lineno">  864</span>              <span class="comment">/* Read data from DR */</span></div>
<div class="line"><span class="lineno">  865</span>              i++;</div>
<div class="line"><span class="lineno">  866</span>              buf[i] = I2CX-&gt;DR;</div>
<div class="line"><span class="lineno">  867</span>            }</div>
<div class="line"><span class="lineno">  868</span> </div>
<div class="line"><span class="lineno">  869</span>       }</div>
<div class="line"><span class="lineno">  870</span>    }</div>
<div class="line"><span class="lineno">  871</span>  </div>
<div class="line"><span class="lineno">  872</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="i2c-std_8c.html#a72d50ac236d15d870b94b98d6a83ddf9">i2c_read_last3byte_std</a>(I2CX,(uint8_t *) &amp;buf[n-3]);</div>
<div class="line"><span class="lineno">  873</span>}</div>
<div class="ttc" id="abasic_8h_html_a793bbd5374ca9d6747044316c4ef9e0e"><div class="ttname"><a href="basic_8h.html#a793bbd5374ca9d6747044316c4ef9e0e">bits_is_set</a></div><div class="ttdeci">#define bits_is_set(data, bits)</div><div class="ttdef"><b>Definition:</b> <a href="basic_8h_source.html#l00054">basic.h:54</a></div></div>
<div class="ttc" id="ai2c-std_8c_html_a72d50ac236d15d870b94b98d6a83ddf9"><div class="ttname"><a href="i2c-std_8c.html#a72d50ac236d15d870b94b98d6a83ddf9">i2c_read_last3byte_std</a></div><div class="ttdeci">static uint8_t i2c_read_last3byte_std(I2C_TypeDef *I2CX, uint8_t *buf)</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8c_source.html#l00766">i2c-std.c:766</a></div></div>
<div class="ttc" id="ai2c-std_8c_html_a7faf3e8c9f72d7e07e7167fbd1d0bdaa"><div class="ttname"><a href="i2c-std_8c.html#a7faf3e8c9f72d7e07e7167fbd1d0bdaa">i2c_read_last2byte_std</a></div><div class="ttdeci">static uint8_t i2c_read_last2byte_std(I2C_TypeDef *I2CX, uint8_t *buf)</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8c_source.html#l00731">i2c-std.c:731</a></div></div>
<div class="ttc" id="ai2c-std_8c_html_ac5bbd8798c3b5a0a1b72f237ef2b2d82"><div class="ttname"><a href="i2c-std_8c.html#ac5bbd8798c3b5a0a1b72f237ef2b2d82">i2c_read_lastbyte_std</a></div><div class="ttdeci">static uint8_t i2c_read_lastbyte_std(I2C_TypeDef *I2CX, uint8_t *buf)</div><div class="ttdoc">send a n bytes via I2C bus</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8c_source.html#l00693">i2c-std.c:693</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="i2c-std_8h_source.html#l00110">_I2C_CLEAR_ADDRFLAG</a>, <a class="el" href="basic_8h_source.html#l00054">bits_is_set</a>, <a class="el" href="init-macro_8h_source.html#l00016">CLEAR_BIT</a>, <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, <a class="el" href="i2c-std_8c_source.html#l00731">i2c_read_last2byte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00766">i2c_read_last3byte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00693">i2c_read_lastbyte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00497">i2c_wait_read_byte_rxne_std()</a>, and <a class="el" href="init-macro_8h_source.html#l00014">SET_BIT</a>.</p>

<p class="reference">Referenced by <a class="el" href="i2c-std_8c_source.html#l01288">i2c_read_7bit_base_nbyte_std()</a>, and <a class="el" href="i2c-std_8c_source.html#l01039">i2c_read_7bit_nbyte_std()</a>.</p>

</div>
</div>
<a id="af1e961a5d80b477de6216bae4fd1a13c" name="af1e961a5d80b477de6216bae4fd1a13c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1e961a5d80b477de6216bae4fd1a13c">&#9670;&#160;</a></span>i2c_ready_std()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_ready_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="i2c-std_8c.html">i2c-std.c</a> </p>
<p>checks that I2C bus &amp; the module is in Idle state</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">student</td><td>Sameer Almaldein*</td></tr>
    <tr><td class="paramname">ID</td><td>679699 </td></tr>
    <tr><td class="paramname">University</td><td>TU-Chemnitz </td></tr>
    <tr><td class="paramname">Master</td><td>: ASE(Automotive Software Engineering )</td></tr>
  </table>
  </dd>
</dl>
<p>when the I2C module is in the idle state that means BUSY Flag is reset (BUSY=0) BUSY: Bus busy 0: No communication on the bus 1: Communication ongoing on the bus  Set by hardware on detection of SDA or SCL low  cleared by hardware on detection of a Stop condition. It indicates a communication in progress on the bus. This information is still updated when the interface is disabled (PE=0).</p>
<p>I2C_BUSY_CONDITION_ERROR: if a timeout is passed without detecting a BUSY=0 then set an error condition to handle this error after 3 times try then reset the I2C and reconfigure it it could be the system is halt and need reset. <br  />
 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">I2CX</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t </dd></dl>

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00077">77</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   78</span>{</div>
<div class="line"><span class="lineno">   79</span>   <a class="code hl_variable" href="i2c-std_8c.html#afe83ed5d7df372f9dcd44526309ef239">I2Cx_Timeout</a>=<a class="code hl_define" href="i2c-std_8h.html#ab0176c4da537dd1a02b4828483da1e0e">I2C_MAX_BUSY_TIME</a>;    </div>
<div class="line"><span class="lineno">   80</span>    <span class="comment">//_delay_ms(25);</span></div>
<div class="line"><span class="lineno">   81</span>  <span class="comment">//wait check that the I2c module is not busy</span></div>
<div class="line"><span class="lineno">   82</span>  </div>
<div class="line"><span class="lineno">   83</span>    <span class="keywordflow">while</span>(<a class="code hl_define" href="basic_8h.html#a793bbd5374ca9d6747044316c4ef9e0e">bits_is_set</a>(I2CX-&gt;SR2,I2C_SR2_BUSY))<span class="comment">//I2C_GetFlagStatus(I2CX,I2C_FLAG_BUSY))</span></div>
<div class="line"><span class="lineno">   84</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="i2c-std_8c.html#afe83ed5d7df372f9dcd44526309ef239">I2Cx_Timeout</a>==0)  </div>
<div class="line"><span class="lineno">   85</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a0d748db2080492b4ec3bb9872e1c2ebd">I2C_BUSY_ERROR</a>;         <span class="comment">// set the error then exit:: I2C_BUSY_ERROR</span></div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>   <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;   </div>
<div class="line"><span class="lineno">   88</span>}    </div>
<div class="ttc" id="ai2c-std_8c_html_afe83ed5d7df372f9dcd44526309ef239"><div class="ttname"><a href="i2c-std_8c.html#afe83ed5d7df372f9dcd44526309ef239">I2Cx_Timeout</a></div><div class="ttdeci">volatile uint32_t I2Cx_Timeout</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8c_source.html#l00051">i2c-std.c:51</a></div></div>
<div class="ttc" id="ai2c-std_8h_html_ab0176c4da537dd1a02b4828483da1e0e"><div class="ttname"><a href="i2c-std_8h.html#ab0176c4da537dd1a02b4828483da1e0e">I2C_MAX_BUSY_TIME</a></div><div class="ttdeci">#define I2C_MAX_BUSY_TIME</div><div class="ttdoc">i2c-std.h</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8h_source.html#l00026">i2c-std.h:26</a></div></div>
<div class="ttc" id="ai2c-std_8h_html_ac8daa3f8c12741492c20cf528dbb2019a0d748db2080492b4ec3bb9872e1c2ebd"><div class="ttname"><a href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a0d748db2080492b4ec3bb9872e1c2ebd">I2C_BUSY_ERROR</a></div><div class="ttdeci">@ I2C_BUSY_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8h_source.html#l00065">i2c-std.h:65</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic_8h_source.html#l00054">bits_is_set</a>, <a class="el" href="i2c-std_8h_source.html#l00065">I2C_BUSY_ERROR</a>, <a class="el" href="i2c-std_8h_source.html#l00026">I2C_MAX_BUSY_TIME</a>, <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, and <a class="el" href="i2c-std_8c_source.html#l00051">I2Cx_Timeout</a>.</p>

<p class="reference">Referenced by <a class="el" href="i2c-std_8c_source.html#l01288">i2c_read_7bit_base_nbyte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l01039">i2c_read_7bit_nbyte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l01078">i2c_write_7bit_base_byte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l01124">i2c_write_7bit_base_nbyte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00962">i2c_write_7bit_byte_std()</a>, and <a class="el" href="i2c-std_8c_source.html#l00990">i2c_write_7bit_nbyte_std()</a>.</p>

</div>
</div>
<a id="a0dea06de59953fa06db4da2938b4b159" name="a0dea06de59953fa06db4da2938b4b159"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dea06de59953fa06db4da2938b4b159">&#9670;&#160;</a></span>i2c_send_7bit_slave_address_rd_std()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_send_7bit_slave_address_rd_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slave_address</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>send a slave with write operation via I2C bus </p>
<p>send a slave with read operation via I2C bus</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">I2CX</td><td></td></tr>
    <tr><td class="paramname">slave_address</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t </dd></dl>

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00634">634</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  635</span>{ </div>
<div class="line"><span class="lineno">  636</span>    uint8_t error=<a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;</div>
<div class="line"><span class="lineno">  637</span>    <span class="comment">//(void)I2CX-&gt;SR1;</span></div>
<div class="line"><span class="lineno">  638</span>       <span class="comment">//I2CX-&gt;DR = slave_address | 0x01;</span></div>
<div class="line"><span class="lineno">  639</span>     I2CX-&gt;DR = <a class="code hl_define" href="i2c-std_8h.html#ac1d3ff70d89012f8805ee1b948cd7d82">I2C_7BIT_ADD_READ</a>(slave_address); <span class="comment">//I2C_Send7bitAddress(I2CX,slave_address,I2C_Direction_Receiver);</span></div>
<div class="line"><span class="lineno">  640</span>     </div>
<div class="line"><span class="lineno">  641</span>     <span class="comment">// wait until the slave acknowledge  BUSY, MSL, ADDR flags are all set </span></div>
<div class="line"><span class="lineno">  642</span>     error=<a class="code hl_function" href="i2c-std_8c.html#a5ec15e339f7c57d8bc30c5ed2c2722e7">i2c_wait_7bit_slave_address_rd_std</a>(I2CX);</div>
<div class="line"><span class="lineno">  643</span>     <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno">  644</span>}</div>
<div class="ttc" id="ai2c-std_8c_html_a5ec15e339f7c57d8bc30c5ed2c2722e7"><div class="ttname"><a href="i2c-std_8c.html#a5ec15e339f7c57d8bc30c5ed2c2722e7">i2c_wait_7bit_slave_address_rd_std</a></div><div class="ttdeci">static uint8_t i2c_wait_7bit_slave_address_rd_std(I2C_TypeDef *I2CX)</div><div class="ttdoc">wait the slave address acknowledge Master_Write</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8c_source.html#l00353">i2c-std.c:353</a></div></div>
<div class="ttc" id="ai2c-std_8h_html_ac1d3ff70d89012f8805ee1b948cd7d82"><div class="ttname"><a href="i2c-std_8h.html#ac1d3ff70d89012f8805ee1b948cd7d82">I2C_7BIT_ADD_READ</a></div><div class="ttdeci">#define I2C_7BIT_ADD_READ(ADDRESS)</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8h_source.html#l00039">i2c-std.h:39</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="i2c-std_8h_source.html#l00039">I2C_7BIT_ADD_READ</a>, <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, and <a class="el" href="i2c-std_8c_source.html#l00353">i2c_wait_7bit_slave_address_rd_std()</a>.</p>

<p class="reference">Referenced by <a class="el" href="i2c-std_8c_source.html#l01288">i2c_read_7bit_base_nbyte_std()</a>, and <a class="el" href="i2c-std_8c_source.html#l01039">i2c_read_7bit_nbyte_std()</a>.</p>

</div>
</div>
<a id="ad8d46b2367148047111a79daa00a9ca2" name="ad8d46b2367148047111a79daa00a9ca2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8d46b2367148047111a79daa00a9ca2">&#9670;&#160;</a></span>i2c_send_7bit_slave_address_wr_std()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_send_7bit_slave_address_wr_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slave_address</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>initiate stop condition </p>
<p>send a slave with write operation via I2C bus</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">I2CX</td><td></td></tr>
    <tr><td class="paramname">slave_address</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>* uint8_t </dd></dl>

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00602">602</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  603</span>{</div>
<div class="line"><span class="lineno">  604</span>      <span class="comment">//(void)I2CX-&gt;SR1;</span></div>
<div class="line"><span class="lineno">  605</span>    uint8_t error=0;</div>
<div class="line"><span class="lineno">  606</span>    </div>
<div class="line"><span class="lineno">  607</span>    <span class="comment">/* Send slave address */</span></div>
<div class="line"><span class="lineno">  608</span>     <span class="comment">//I2CX-&gt;DR = slave_address &amp; 0xfe;</span></div>
<div class="line"><span class="lineno">  609</span>     I2CX-&gt;DR = <a class="code hl_define" href="i2c-std_8h.html#a4ba8fd8ea55f70e0b9e5243de50a72d8">I2C_7BIT_ADD_WRITE</a>(slave_address); <span class="comment">//I2C_Send7bitAddress(I2CX,slave_address,I2C_Direction_Transmitter);</span></div>
<div class="line"><span class="lineno">  610</span>   </div>
<div class="line"><span class="lineno">  611</span>    <span class="comment">// wait until the slave acknowledge  BUSY, MSL, ADDR, TXE and TRA flags are all set </span></div>
<div class="line"><span class="lineno">  612</span>    error=<a class="code hl_function" href="i2c-std_8c.html#ab51a83fd8a35bbe5e610be751cc773a4">i2c_wait_7bit_slave_address_wr_std</a>(I2CX);</div>
<div class="line"><span class="lineno">  613</span>    </div>
<div class="line"><span class="lineno">  614</span>    <span class="keywordflow">if</span>(error==<a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>)</div>
<div class="line"><span class="lineno">  615</span>    {</div>
<div class="line"><span class="lineno">  616</span>      <span class="comment">/* Clear ADDR flag */</span></div>
<div class="line"><span class="lineno">  617</span>       <a class="code hl_define" href="i2c-std_8h.html#a22a728f90de94e71843c18f0650f18b3">_I2C_CLEAR_ADDRFLAG</a>(I2CX);</div>
<div class="line"><span class="lineno">  618</span> </div>
<div class="line"><span class="lineno">  619</span>        <span class="comment">/* Wait until TXE flag is set */</span></div>
<div class="line"><span class="lineno">  620</span>      error=<a class="code hl_function" href="i2c-std_8c.html#a09766e33b0b082d13065b3e03e2bb6d3">i2c_wait_write_byte_txe_std</a>(I2CX);</div>
<div class="line"><span class="lineno">  621</span> </div>
<div class="line"><span class="lineno">  622</span>    }</div>
<div class="line"><span class="lineno">  623</span> </div>
<div class="line"><span class="lineno">  624</span>    <span class="keywordflow">return</span> error;    </div>
<div class="line"><span class="lineno">  625</span>}</div>
<div class="ttc" id="ai2c-std_8c_html_a09766e33b0b082d13065b3e03e2bb6d3"><div class="ttname"><a href="i2c-std_8c.html#a09766e33b0b082d13065b3e03e2bb6d3">i2c_wait_write_byte_txe_std</a></div><div class="ttdeci">static uint8_t i2c_wait_write_byte_txe_std(I2C_TypeDef *I2CX)</div><div class="ttdoc">wait the slave address acknowledge Master_Read</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8c_source.html#l00444">i2c-std.c:444</a></div></div>
<div class="ttc" id="ai2c-std_8c_html_ab51a83fd8a35bbe5e610be751cc773a4"><div class="ttname"><a href="i2c-std_8c.html#ab51a83fd8a35bbe5e610be751cc773a4">i2c_wait_7bit_slave_address_wr_std</a></div><div class="ttdeci">static uint8_t i2c_wait_7bit_slave_address_wr_std(I2C_TypeDef *I2CX)</div><div class="ttdoc">wait stop condition is complete STOPF=1</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8c_source.html#l00278">i2c-std.c:278</a></div></div>
<div class="ttc" id="ai2c-std_8h_html_a4ba8fd8ea55f70e0b9e5243de50a72d8"><div class="ttname"><a href="i2c-std_8h.html#a4ba8fd8ea55f70e0b9e5243de50a72d8">I2C_7BIT_ADD_WRITE</a></div><div class="ttdeci">#define I2C_7BIT_ADD_WRITE(ADDRESS)</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8h_source.html#l00038">i2c-std.h:38</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="i2c-std_8h_source.html#l00110">_I2C_CLEAR_ADDRFLAG</a>, <a class="el" href="i2c-std_8h_source.html#l00038">I2C_7BIT_ADD_WRITE</a>, <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, <a class="el" href="i2c-std_8c_source.html#l00278">i2c_wait_7bit_slave_address_wr_std()</a>, and <a class="el" href="i2c-std_8c_source.html#l00444">i2c_wait_write_byte_txe_std()</a>.</p>

<p class="reference">Referenced by <a class="el" href="i2c-std_8c_source.html#l01288">i2c_read_7bit_base_nbyte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l01078">i2c_write_7bit_base_byte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l01124">i2c_write_7bit_base_nbyte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00962">i2c_write_7bit_byte_std()</a>, and <a class="el" href="i2c-std_8c_source.html#l00990">i2c_write_7bit_nbyte_std()</a>.</p>

</div>
</div>
<a id="ab94774de700d4b23afd5fdeb2e7bd720" name="ab94774de700d4b23afd5fdeb2e7bd720"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab94774de700d4b23afd5fdeb2e7bd720">&#9670;&#160;</a></span>i2c_start_std()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_start_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>wait the complete of current byte receiption (MASTER-read) using BTF </p>
<p>initiate start condition</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">I2CX</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t </dd></dl>

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00564">564</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  565</span>{ </div>
<div class="line"><span class="lineno">  566</span>   <span class="comment">// activate PE</span></div>
<div class="line"><span class="lineno">  567</span>    <span class="comment">//CLEAR_BIT(I2CX-&gt;CR1,I2C_CR1_PE);</span></div>
<div class="line"><span class="lineno">  568</span>    <a class="code hl_define" href="group__Exported__macros.html#ga26474f43799fbade9cf300e21dd3a91a">SET_BIT</a>(I2CX-&gt;CR1,I2C_CR1_PE);</div>
<div class="line"><span class="lineno">  569</span>   <span class="comment">// clear all error flags</span></div>
<div class="line"><span class="lineno">  570</span>    <a class="code hl_define" href="group__Exported__macros.html#ga133aae6fc0d41bffab39ab223a7001de">CLEAR_BIT</a>(I2CX-&gt;SR1,I2C_SR1_BERR|I2C_SR1_ARLO|I2C_SR1_AF|I2C_SR1_OVR);</div>
<div class="line"><span class="lineno">  571</span>   <span class="comment">// Disable Pos</span></div>
<div class="line"><span class="lineno">  572</span>   <a class="code hl_define" href="group__Exported__macros.html#ga133aae6fc0d41bffab39ab223a7001de">CLEAR_BIT</a>(I2CX-&gt;CR1, I2C_CR1_POS);</div>
<div class="line"><span class="lineno">  573</span>   <span class="comment">// Enable acknowledgment</span></div>
<div class="line"><span class="lineno">  574</span>   <a class="code hl_define" href="group__Exported__macros.html#ga26474f43799fbade9cf300e21dd3a91a">SET_BIT</a>(I2CX-&gt;CR1,I2C_CR1_ACK);</div>
<div class="line"><span class="lineno">  575</span>   <span class="comment">// send the start condition </span></div>
<div class="line"><span class="lineno">  576</span>   <a class="code hl_define" href="group__Exported__macros.html#ga26474f43799fbade9cf300e21dd3a91a">SET_BIT</a>(I2CX-&gt;CR1,I2C_CR1_START); <span class="comment">//I2C_GenerateSTART(I2CX,ENABLE);</span></div>
<div class="line"><span class="lineno">  577</span>  <span class="comment">//wait the event I2C_EVENT_MASTER_MODE_SELECT where BUSY, MSL and SB flag are set  </span></div>
<div class="line"><span class="lineno">  578</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="i2c-std_8c.html#a85ef801a46f276dfe5d33dc99ae73488">i2c_wait_start_event_std</a>(I2CX);</div>
<div class="line"><span class="lineno">  579</span>}                           </div>
<div class="ttc" id="ai2c-std_8c_html_a85ef801a46f276dfe5d33dc99ae73488"><div class="ttname"><a href="i2c-std_8c.html#a85ef801a46f276dfe5d33dc99ae73488">i2c_wait_start_event_std</a></div><div class="ttdeci">static uint8_t i2c_wait_start_event_std(I2C_TypeDef *I2CX)</div><div class="ttdoc">wait until I2C bus is Idle BUSY=0</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8c_source.html#l00129">i2c-std.c:129</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="init-macro_8h_source.html#l00016">CLEAR_BIT</a>, <a class="el" href="i2c-std_8c_source.html#l00129">i2c_wait_start_event_std()</a>, and <a class="el" href="init-macro_8h_source.html#l00014">SET_BIT</a>.</p>

<p class="reference">Referenced by <a class="el" href="i2c-std_8c_source.html#l01288">i2c_read_7bit_base_nbyte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l01039">i2c_read_7bit_nbyte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l01078">i2c_write_7bit_base_byte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l01124">i2c_write_7bit_base_nbyte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00962">i2c_write_7bit_byte_std()</a>, and <a class="el" href="i2c-std_8c_source.html#l00990">i2c_write_7bit_nbyte_std()</a>.</p>

</div>
</div>
<a id="a148f10682cf5ebeb939bbed609a54ac9" name="a148f10682cf5ebeb939bbed609a54ac9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a148f10682cf5ebeb939bbed609a54ac9">&#9670;&#160;</a></span>i2c_stop_std()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_stop_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>initiate start condition </p>
<p>initiate stop condition</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">I2CX</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t </dd></dl>

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00587">587</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  588</span>{</div>
<div class="line"><span class="lineno">  589</span>    <span class="comment">// generate the stop condition </span></div>
<div class="line"><span class="lineno">  590</span>      <a class="code hl_define" href="group__Exported__macros.html#ga26474f43799fbade9cf300e21dd3a91a">SET_BIT</a>(I2CX-&gt;CR1,I2C_CR1_STOP); <span class="comment">//I2C_GenerateSTOP(I2CX,ENABLE);</span></div>
<div class="line"><span class="lineno">  591</span>    <span class="comment">// wait until stop condition is complete STOPF is set</span></div>
<div class="line"><span class="lineno">  592</span>     <span class="keywordflow">return</span> <a class="code hl_function" href="i2c-std_8c.html#af2c67f3e11cf30f0a8ca085d89fa0bd1">i2c_wait_stop_event_std</a>(I2CX);</div>
<div class="line"><span class="lineno">  593</span>}               </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="i2c-std_8c_source.html#l00183">i2c_wait_stop_event_std()</a>, and <a class="el" href="init-macro_8h_source.html#l00014">SET_BIT</a>.</p>

<p class="reference">Referenced by <a class="el" href="i2c-std_8c_source.html#l01078">i2c_write_7bit_base_byte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l01124">i2c_write_7bit_base_nbyte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00962">i2c_write_7bit_byte_std()</a>, and <a class="el" href="i2c-std_8c_source.html#l00990">i2c_write_7bit_nbyte_std()</a>.</p>

</div>
</div>
<a id="a5ec15e339f7c57d8bc30c5ed2c2722e7" name="a5ec15e339f7c57d8bc30c5ed2c2722e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ec15e339f7c57d8bc30c5ed2c2722e7">&#9670;&#160;</a></span>i2c_wait_7bit_slave_address_rd_std()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_wait_7bit_slave_address_rd_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>wait the slave address acknowledge Master_Write </p>
<p>Waits the until the slave acknowledges back to the reception of its address in read mode.</p>
<p>check that the slave aknowledges back as it receives its address the flags BUSY, MSL and ADDR flags which all set TRA=0 TXE= 1 no need to check it as the master will go to receiver mode after ADDR=1 indicates End of address transmission which is defined by the slave acknowledgment (ACK) TRA=0 indicates Receiver mode set depending on the R/W bit of the address byte BUSY=1 indicates the I2C is busy (no arbitration lost or peripheral) MSL=1 indicates Master mode I2C_SR1 : I2C Status register 1 ADDR: This bit is cleared by software reading SR1 register followed reading SR2, or by hardware when PE=0. 1.Slave :: Address matched (Slave) 0: Address mismatched or not received. 1: Received address matched</p>
<ol type="1">
<li>Master : Address sent (Master) 0: No end of address transmission 1: End of address transmission  For 10-bit addressing, the bit is set after the ACK of the 2nd byte.  For 7-bit addressing, the bit is set after the ACK Note: ADDR is not set after a NACK reception</li>
</ol>
<p>I2C_SR2 : I2C Status register 2 <br  />
 TRA: Transmitter/receiver 0: Data bytes received 1: Data bytes transmitted This bit is set depending on the R/W bit of the address byte, at the end of total address phase. It is also cleared by hardware after detection of Stop condition (STOPF=1), repeated Start condition, loss of bus arbitration (ARLO=1), or when PE=0. BUSY: Bus busy 0: No communication on the bus 1: Communication ongoing on the bus  Set by hardware on detection of SDA or SCL low  cleared by hardware on detection of a Stop condition. It indicates a communication in progress on the bus. This information is still updated when the interface is disabled (PE=0). MSL: Master/slave 0: Slave Mode 1: Master Mode  Set by hardware as soon as the interface is in Master mode (SB=1).  Cleared by hardware after detecting a Stop condition on the bus or a loss of arbitration (ARLO=1), or by hardware when PE=0.</p>
<p>I2C_SLAVE_ADDRESS_NACK_ERROR: if a timeout is passed without detecting a ADDR=1 then set an error condition <br  />
 which indicates that no slave has acknowledged on the I2C bus either no one has this address or that slave has an issue to check </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">I2CX</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t <br  />
 </dd></dl>
<p>wait the slave address acknowledge Master_Read</p>
<p>I2C_CheckEvent(I2CX,I2C_EVENT_MASTER_RECEIVER_MODE_SELECTED)) // while(I2C_GetFlagStatus(I2CX , I2C_FLAG_ADDR))</p>

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00353">353</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  354</span>{</div>
<div class="line"><span class="lineno">  356</span>     <a class="code hl_variable" href="i2c-std_8c.html#afe83ed5d7df372f9dcd44526309ef239">I2Cx_Timeout</a>=<a class="code hl_define" href="i2c-std_8h.html#a52796b3a6cf92d6b16bf5e2164e65146">I2C_MAX_WAIT_TIME</a>;  </div>
<div class="line"><span class="lineno">  357</span>    <span class="comment">// wait until the slave acknowledge  BUSY, MSL, ADDR flags are all set </span></div>
<div class="line"><span class="lineno">  358</span>    <span class="keywordflow">while</span>(<a class="code hl_define" href="basic_8h.html#aa239d38020eac3ff2bea1a5e1c30c5a9">bits_is_clear</a>(I2CX-&gt;SR1,I2C_SR1_ADDR) || <a class="code hl_define" href="basic_8h.html#aa239d38020eac3ff2bea1a5e1c30c5a9">bits_is_clear</a>(I2CX-&gt;SR2,(uint16_t)(I2C_SR2_BUSY|I2C_SR2_MSL)))</div>
<div class="line"><span class="lineno">  359</span>     {</div>
<div class="line"><span class="lineno">  360</span>      <span class="keywordflow">if</span>(<a class="code hl_define" href="basic_8h.html#a793bbd5374ca9d6747044316c4ef9e0e">bits_is_set</a>(I2CX-&gt;SR1,I2C_SR1_AF))  </div>
<div class="line"><span class="lineno">  361</span>      {</div>
<div class="line"><span class="lineno">  362</span>        <span class="comment">/* Generate Stop */</span></div>
<div class="line"><span class="lineno">  363</span>        <a class="code hl_define" href="group__Exported__macros.html#ga26474f43799fbade9cf300e21dd3a91a">SET_BIT</a>(I2CX-&gt;CR1, I2C_CR1_STOP);</div>
<div class="line"><span class="lineno">  364</span>        <span class="comment">/* Clear AF Flag */</span></div>
<div class="line"><span class="lineno">  365</span>        <a class="code hl_define" href="group__Exported__macros.html#ga133aae6fc0d41bffab39ab223a7001de">CLEAR_BIT</a>(I2CX-&gt;SR1,I2C_FLAG_AF);  <span class="comment">//_I2C_CLEAR_FLAG(hi2c, I2C_FLAG_AF);</span></div>
<div class="line"><span class="lineno">  366</span>        </div>
<div class="line"><span class="lineno">  367</span>      <span class="comment">// I2C_SLAVE_ADDRESS_NACK Acknowledge no slave with this address at the bus</span></div>
<div class="line"><span class="lineno">  368</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a3c2a9f4442f725c4c67e42910f0ba7e8">I2C_NACK_ERROR</a>;</div>
<div class="line"><span class="lineno">  369</span>      }        </div>
<div class="line"><span class="lineno">  370</span>     <span class="keywordflow">if</span>(<a class="code hl_variable" href="i2c-std_8c.html#afe83ed5d7df372f9dcd44526309ef239">I2Cx_Timeout</a>==0)</div>
<div class="line"><span class="lineno">  371</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a1056d6a4b037e383132309c2898a2fc8">I2C_TIMEOUT</a>; <span class="comment">//I2C_ERROR</span></div>
<div class="line"><span class="lineno">  372</span>    }</div>
<div class="line"><span class="lineno">  373</span> </div>
<div class="line"><span class="lineno">  374</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>; </div>
<div class="line"><span class="lineno">  375</span>}</div>
<div class="ttc" id="ai2c-std_8h_html_ac8daa3f8c12741492c20cf528dbb2019a1056d6a4b037e383132309c2898a2fc8"><div class="ttname"><a href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a1056d6a4b037e383132309c2898a2fc8">I2C_TIMEOUT</a></div><div class="ttdeci">@ I2C_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8h_source.html#l00061">i2c-std.h:61</a></div></div>
<div class="ttc" id="ai2c-std_8h_html_ac8daa3f8c12741492c20cf528dbb2019a3c2a9f4442f725c4c67e42910f0ba7e8"><div class="ttname"><a href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a3c2a9f4442f725c4c67e42910f0ba7e8">I2C_NACK_ERROR</a></div><div class="ttdeci">@ I2C_NACK_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8h_source.html#l00068">i2c-std.h:68</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic_8h_source.html#l00055">bits_is_clear</a>, <a class="el" href="basic_8h_source.html#l00054">bits_is_set</a>, <a class="el" href="init-macro_8h_source.html#l00016">CLEAR_BIT</a>, <a class="el" href="i2c-std_8h_source.html#l00027">I2C_MAX_WAIT_TIME</a>, <a class="el" href="i2c-std_8h_source.html#l00068">I2C_NACK_ERROR</a>, <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, <a class="el" href="i2c-std_8h_source.html#l00061">I2C_TIMEOUT</a>, <a class="el" href="i2c-std_8c_source.html#l00051">I2Cx_Timeout</a>, and <a class="el" href="init-macro_8h_source.html#l00014">SET_BIT</a>.</p>

<p class="reference">Referenced by <a class="el" href="i2c-std_8c_source.html#l00634">i2c_send_7bit_slave_address_rd_std()</a>.</p>

</div>
</div>
<a id="ab51a83fd8a35bbe5e610be751cc773a4" name="ab51a83fd8a35bbe5e610be751cc773a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab51a83fd8a35bbe5e610be751cc773a4">&#9670;&#160;</a></span>i2c_wait_7bit_slave_address_wr_std()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_wait_7bit_slave_address_wr_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>wait stop condition is complete STOPF=1 </p>
<p>Waits until the slave acknowledges back to the reception of its address in write mode <br  />
</p>
<p>check that the slave aknowledges back as it receives its address the flags BUSY, MSL, ADDR, TXE and TRA which all set during EV6 EV6: ADDR=1, cleared by reading SR1 register followed by reading SR2. TXE= 1 indicates that Data register empty that means th address is sent to shift-register and transmission is either on process or even done ADDR=1 indicates End of address transmission which is defined by the slave acknowledgment (ACK) TRA=1 indicates Transmitter mode set depending on the R/W bit of the address byte BUSY=1 indicates the I2C is busy (no arbitration lost or peripheral) MSL=1 indicates Master mode I2C_SR1 : I2C Status register 1 TXE: Data register empty (transmitters) 0: Data register not empty 1: Data register empty  Set when DR is empty in transmission. TxE is not set during address phase.  Cleared by software writing to the DR register or by hardware after a start or a stop condition or when PE=0. TxE is not set if either a NACK is received, or if next byte to be transmitted is PEC (PEC=1) Note: TxE is not cleared by writing the first data being transmitted, or by writing data when BTF is set, as in both cases the data register is still empty. ADDR: This bit is cleared by software reading SR1 register followed reading SR2, or by hardware when PE=0. 1.Slave :: Address matched (Slave) 0: Address mismatched or not received. 1: Received address matched</p>
<ol type="1">
<li>Master : Address sent (Master) 0: No end of address transmission 1: End of address transmission  For 10-bit addressing, the bit is set after the ACK of the 2nd byte.  For 7-bit addressing, the bit is set after the ACK Note: ADDR is not set after a NACK reception</li>
</ol>
<p>I2C_SR2 : I2C Status register 2 <br  />
 TRA: Transmitter/receiver 0: Data bytes received 1: Data bytes transmitted This bit is set depending on the R/W bit of the address byte, at the end of total address phase. It is also cleared by hardware after detection of Stop condition (STOPF=1), repeated Start condition, loss of bus arbitration (ARLO=1), or when PE=0. BUSY: Bus busy 0: No communication on the bus 1: Communication ongoing on the bus  Set by hardware on detection of SDA or SCL low  cleared by hardware on detection of a Stop condition. It indicates a communication in progress on the bus. This information is still updated when the interface is disabled (PE=0). MSL: Master/slave 0: Slave Mode 1: Master Mode  Set by hardware as soon as the interface is in Master mode (SB=1).  Cleared by hardware after detecting a Stop condition on the bus or a loss of arbitration (ARLO=1), or by hardware when PE=0.</p>
<p>I2C_SLAVE_ADDRESS_NACK_ERROR: if a timeout is passed without detecting a ADDR=1 then set an error condition <br  />
 which indicates that no slave has acknowledged on the I2C bus either no one has this address or that slave has an issue to check </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">I2CX</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t <br  />
 </dd></dl>
<p>wait the slave address acknowledge Master_Write</p>

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00278">278</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  279</span>{</div>
<div class="line"><span class="lineno">  281</span>    <a class="code hl_variable" href="i2c-std_8c.html#afe83ed5d7df372f9dcd44526309ef239">I2Cx_Timeout</a>=<a class="code hl_define" href="i2c-std_8h.html#a52796b3a6cf92d6b16bf5e2164e65146">I2C_MAX_WAIT_TIME</a>;  </div>
<div class="line"><span class="lineno">  282</span>  <span class="comment">// wait until the slave acknowledge  BUSY, MSL, ADDR, TXE and TRA flags are all set during Ev6</span></div>
<div class="line"><span class="lineno">  283</span>  <span class="comment">//  EV6: ADDR=1, cleared by reading SR1 register followed by reading SR2. </span></div>
<div class="line"><span class="lineno">  284</span>    <span class="keywordflow">while</span>(<a class="code hl_define" href="basic_8h.html#aa239d38020eac3ff2bea1a5e1c30c5a9">bits_is_clear</a>(I2CX-&gt;SR1,I2C_SR1_ADDR))</div>
<div class="line"><span class="lineno">  285</span>          <span class="comment">//bits_is_clear(I2CX-&gt;SR2,(uint16_t)(I2C_SR2_BUSY|I2C_SR2_MSL|I2C_SR2_TRA)))   //!I2C_CheckEvent(I2CX,I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED))</span></div>
<div class="line"><span class="lineno">  286</span>    {</div>
<div class="line"><span class="lineno">  287</span>      <span class="keywordflow">if</span>(<a class="code hl_define" href="basic_8h.html#a793bbd5374ca9d6747044316c4ef9e0e">bits_is_set</a>(I2CX-&gt;SR1,I2C_SR1_AF))  </div>
<div class="line"><span class="lineno">  288</span>      {</div>
<div class="line"><span class="lineno">  289</span>        <span class="comment">/* Generate Stop */</span></div>
<div class="line"><span class="lineno">  290</span>        <a class="code hl_define" href="group__Exported__macros.html#ga26474f43799fbade9cf300e21dd3a91a">SET_BIT</a>(I2CX-&gt;CR1, I2C_CR1_STOP);</div>
<div class="line"><span class="lineno">  291</span>        <span class="comment">/* Clear AF Flag */</span></div>
<div class="line"><span class="lineno">  292</span>        <a class="code hl_define" href="group__Exported__macros.html#ga133aae6fc0d41bffab39ab223a7001de">CLEAR_BIT</a>(I2CX-&gt;SR1,I2C_FLAG_AF);  <span class="comment">//_I2C_CLEAR_FLAG(hi2c, I2C_FLAG_AF);</span></div>
<div class="line"><span class="lineno">  293</span>        </div>
<div class="line"><span class="lineno">  294</span>      <span class="comment">// I2C_NACK Acknowledge no slave with this address at the bus</span></div>
<div class="line"><span class="lineno">  295</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a3c2a9f4442f725c4c67e42910f0ba7e8">I2C_NACK_ERROR</a>;</div>
<div class="line"><span class="lineno">  296</span>     }</div>
<div class="line"><span class="lineno">  297</span>     <span class="keywordflow">if</span>(<a class="code hl_variable" href="i2c-std_8c.html#afe83ed5d7df372f9dcd44526309ef239">I2Cx_Timeout</a>==0)</div>
<div class="line"><span class="lineno">  298</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a1056d6a4b037e383132309c2898a2fc8">I2C_TIMEOUT</a>; <span class="comment">//I2C_ERROR</span></div>
<div class="line"><span class="lineno">  299</span>    }</div>
<div class="line"><span class="lineno">  300</span>   <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>; </div>
<div class="line"><span class="lineno">  301</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic_8h_source.html#l00055">bits_is_clear</a>, <a class="el" href="basic_8h_source.html#l00054">bits_is_set</a>, <a class="el" href="init-macro_8h_source.html#l00016">CLEAR_BIT</a>, <a class="el" href="i2c-std_8h_source.html#l00027">I2C_MAX_WAIT_TIME</a>, <a class="el" href="i2c-std_8h_source.html#l00068">I2C_NACK_ERROR</a>, <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, <a class="el" href="i2c-std_8h_source.html#l00061">I2C_TIMEOUT</a>, <a class="el" href="i2c-std_8c_source.html#l00051">I2Cx_Timeout</a>, and <a class="el" href="init-macro_8h_source.html#l00014">SET_BIT</a>.</p>

<p class="reference">Referenced by <a class="el" href="i2c-std_8c_source.html#l00602">i2c_send_7bit_slave_address_wr_std()</a>.</p>

</div>
</div>
<a id="aa44ef3d7bb87a805a912b65fdd93e960" name="aa44ef3d7bb87a805a912b65fdd93e960"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa44ef3d7bb87a805a912b65fdd93e960">&#9670;&#160;</a></span>i2c_wait_read_byte_btf_std()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_wait_read_byte_btf_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>wait the complete of current byte receiption (MASTER-read) using RXNE </p>
<p>Waits the until the complete receiption of the current data byte.</p>
<p>check that the complete receiption of the current data byte has completed by checking the flag I2C_FLAG_BTF</p>
<p>BTF: Byte transfer finished 0: Data byte transfer not done 1: Data byte transfer succeeded  Set by hardware when NOSTRETCH=0 and:  In reception when a new byte is received (including ACK pulse) and DR has not been read yet (RxNE=1).  In transmission when a new byte should be sent and DR has not been written yet (TxE=1).  Cleared by software reading SR1 followed by either a read or write in the DR register or by</p><ul>
<li>Cleared by hardware after a start or a stop condition in transmission or when PE=0. Note: The BTF bit is not set after a NACK reception</li>
</ul>
<p>I2C_RX_BTF_ERROR: if a timeout is passed without detecting a RNXE=1 then set an error condition <br  />
 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">I2CX</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t <br  />
 </dd></dl>
<p>wait the complete of current byte receiption (MASTER-read) using BTF</p>

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00537">537</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  538</span>{</div>
<div class="line"><span class="lineno">  540</span>  <span class="comment">// EV7_3 -- Wait for BTF , program stop , read data twice</span></div>
<div class="line"><span class="lineno">  541</span>    <a class="code hl_variable" href="i2c-std_8c.html#afe83ed5d7df372f9dcd44526309ef239">I2Cx_Timeout</a>=<a class="code hl_define" href="i2c-std_8h.html#a52796b3a6cf92d6b16bf5e2164e65146">I2C_MAX_WAIT_TIME</a>; </div>
<div class="line"><span class="lineno">  542</span>    <span class="keywordflow">while</span>(<a class="code hl_define" href="basic_8h.html#aa239d38020eac3ff2bea1a5e1c30c5a9">bits_is_clear</a>(I2CX-&gt;SR1,I2C_SR1_BTF)) <span class="comment">//I2C_GetFlagStatus(I2CX,I2C_FLAG_BTF))</span></div>
<div class="line"><span class="lineno">  543</span>    {</div>
<div class="line"><span class="lineno">  544</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="i2c-std_8c.html#afe83ed5d7df372f9dcd44526309ef239">I2Cx_Timeout</a>==0)  </div>
<div class="line"><span class="lineno">  545</span>          <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a28ee3405ef74e2215500f400dbe80929">I2C_RX_BTF_ERROR</a>;<span class="comment">// set the error then exit ::I2C_RX_RXNE_ERROR</span></div>
<div class="line"><span class="lineno">  546</span>     }</div>
<div class="line"><span class="lineno">  547</span> </div>
<div class="line"><span class="lineno">  548</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;</div>
<div class="line"><span class="lineno">  549</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic_8h_source.html#l00055">bits_is_clear</a>, <a class="el" href="i2c-std_8h_source.html#l00027">I2C_MAX_WAIT_TIME</a>, <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, <a class="el" href="i2c-std_8h_source.html#l00074">I2C_RX_BTF_ERROR</a>, and <a class="el" href="i2c-std_8c_source.html#l00051">I2Cx_Timeout</a>.</p>

<p class="reference">Referenced by <a class="el" href="i2c-std_8c_source.html#l00731">i2c_read_last2byte_std()</a>, and <a class="el" href="i2c-std_8c_source.html#l00766">i2c_read_last3byte_std()</a>.</p>

</div>
</div>
<a id="a1614e652c676951bc5a26e5d070ace7b" name="a1614e652c676951bc5a26e5d070ace7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1614e652c676951bc5a26e5d070ace7b">&#9670;&#160;</a></span>i2c_wait_read_byte_rxne_std()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_wait_read_byte_rxne_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>wait the complete of current byte transmition (MASTER-write) </p>
<p>Waits the until the complete receiption of the current data byte.</p>
<p>check that the complete receiption of the current data byte has completed by checking the flag I2C_FLAG_RXNE</p>
<p>RXNE: Data register not empty (receivers) 0: Data register empty 1: Data register not empty  Set when data register is not empty in receiver mode. RxNE is not set during address phase.  Cleared by software reading or writing the DR register or by hardware when PE=0. RxNE is not set in case of ARLO event. RxNE is not cleared by reading data when BTF is set, as the data register is still full.</p>
<p>BTF: Byte transfer finished 0: Data byte transfer not done 1: Data byte transfer succeeded  Set by hardware when NOSTRETCH=0 and:  In reception when a new byte is received (including ACK pulse) and DR has not been read yet (RxNE=1).  In transmission when a new byte should be sent and DR has not been written yet (TxE=1).  Cleared by software reading SR1 followed by either a read or write in the DR register or by</p><ul>
<li>Cleared by hardware after a start or a stop condition in transmission or when PE=0. Note: The BTF bit is not set after a NACK reception</li>
</ul>
<p>I2C_RX_RXNE_ERROR: if a timeout is passed without detecting a RNXE=1 then set an error condition <br  />
 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">I2CX</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t <br  />
 </dd></dl>
<p>wait the complete of current byte receiption (MASTER-read)</p>

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00497">497</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  498</span>{</div>
<div class="line"><span class="lineno">  500</span>     <span class="comment">//Wait until RXNE is set</span></div>
<div class="line"><span class="lineno">  501</span>    <a class="code hl_variable" href="i2c-std_8c.html#afe83ed5d7df372f9dcd44526309ef239">I2Cx_Timeout</a>=<a class="code hl_define" href="i2c-std_8h.html#a52796b3a6cf92d6b16bf5e2164e65146">I2C_MAX_WAIT_TIME</a>; </div>
<div class="line"><span class="lineno">  502</span>    <span class="keywordflow">while</span>(<a class="code hl_define" href="basic_8h.html#aa239d38020eac3ff2bea1a5e1c30c5a9">bits_is_clear</a>(I2CX-&gt;SR1,I2C_SR1_RXNE))<span class="comment">//I2C_GetFlagStatus(I2CX,I2C_FLAG_RXNE))</span></div>
<div class="line"><span class="lineno">  503</span>    {</div>
<div class="line"><span class="lineno">  504</span>      <span class="comment">/* Check if a STOPF is detected */</span></div>
<div class="line"><span class="lineno">  505</span>      <span class="keywordflow">if</span> (<a class="code hl_define" href="basic_8h.html#a793bbd5374ca9d6747044316c4ef9e0e">bits_is_set</a>(I2CX-&gt;SR1,I2C_SR1_STOPF) )</div>
<div class="line"><span class="lineno">  506</span>      {</div>
<div class="line"><span class="lineno">  507</span>          <span class="comment">/* Clear STOP Flag */</span></div>
<div class="line"><span class="lineno">  508</span>           <a class="code hl_define" href="i2c-std_8h.html#a62afbe99c26993afbe1591724d797422">_I2C_CLEAR_STOPFLAG</a>(I2CX);      </div>
<div class="line"><span class="lineno">  509</span>         <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a2e4932a1868432bff23103fac0127fdc">I2C_ERROR</a>;</div>
<div class="line"><span class="lineno">  510</span>      }</div>
<div class="line"><span class="lineno">  511</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="i2c-std_8c.html#afe83ed5d7df372f9dcd44526309ef239">I2Cx_Timeout</a>==0)  </div>
<div class="line"><span class="lineno">  512</span>           <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aa44483709c63d954bebfa6f66ec02470">I2C_RX_RXNE_ERROR</a>;<span class="comment">// set the error then exit ::I2C_RX_RXNE_ERROR</span></div>
<div class="line"><span class="lineno">  513</span>     }</div>
<div class="line"><span class="lineno">  514</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;</div>
<div class="line"><span class="lineno">  515</span>}</div>
<div class="ttc" id="ai2c-std_8h_html_a62afbe99c26993afbe1591724d797422"><div class="ttname"><a href="i2c-std_8h.html#a62afbe99c26993afbe1591724d797422">_I2C_CLEAR_STOPFLAG</a></div><div class="ttdeci">#define _I2C_CLEAR_STOPFLAG(I2Cx)</div><div class="ttdoc">Clears the I2C STOPF pending flag.</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8h_source.html#l00122">i2c-std.h:122</a></div></div>
<div class="ttc" id="ai2c-std_8h_html_ac8daa3f8c12741492c20cf528dbb2019a2e4932a1868432bff23103fac0127fdc"><div class="ttname"><a href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a2e4932a1868432bff23103fac0127fdc">I2C_ERROR</a></div><div class="ttdeci">@ I2C_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8h_source.html#l00076">i2c-std.h:76</a></div></div>
<div class="ttc" id="ai2c-std_8h_html_ac8daa3f8c12741492c20cf528dbb2019aa44483709c63d954bebfa6f66ec02470"><div class="ttname"><a href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aa44483709c63d954bebfa6f66ec02470">I2C_RX_RXNE_ERROR</a></div><div class="ttdeci">@ I2C_RX_RXNE_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8h_source.html#l00073">i2c-std.h:73</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="i2c-std_8h_source.html#l00122">_I2C_CLEAR_STOPFLAG</a>, <a class="el" href="basic_8h_source.html#l00055">bits_is_clear</a>, <a class="el" href="basic_8h_source.html#l00054">bits_is_set</a>, <a class="el" href="i2c-std_8h_source.html#l00076">I2C_ERROR</a>, <a class="el" href="i2c-std_8h_source.html#l00027">I2C_MAX_WAIT_TIME</a>, <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, <a class="el" href="i2c-std_8h_source.html#l00073">I2C_RX_RXNE_ERROR</a>, and <a class="el" href="i2c-std_8c_source.html#l00051">I2Cx_Timeout</a>.</p>

<p class="reference">Referenced by <a class="el" href="i2c-std_8c_source.html#l00693">i2c_read_lastbyte_std()</a>, and <a class="el" href="i2c-std_8c_source.html#l00829">i2c_read_nbyte_std()</a>.</p>

</div>
</div>
<a id="a85ef801a46f276dfe5d33dc99ae73488" name="a85ef801a46f276dfe5d33dc99ae73488"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85ef801a46f276dfe5d33dc99ae73488">&#9670;&#160;</a></span>i2c_wait_start_event_std()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_wait_start_event_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>wait until I2C bus is Idle BUSY=0 </p>
<p>wait the until the start condidtion is completed</p>
<p>check that the start condition is finished by checking the following flags BUSY, MSL and SB flag are all set <br  />
 EV5: at the SB=1, cleared by reading SR1 register followed by writing the DR register. SB= 1 indicates Start condition generated and finished BUSY=1 indicates the I2C is busy (no arbitration lost or peripheral) MSL=1 indicates Master mode I2C_SR1 : I2C Status register 1 SB: Start bit (Master mode) 0: No Start condition 1: Start condition generated.  Set when a Start condition generated.  Cleared by software by reading the SR1 register followed by writing the DR register, or by hardware when PE=0 <br  />
 I2C_SR2 : I2C Status register 2 <br  />
 TRA: Transmitter/receiver 0: Data bytes received 1: Data bytes transmitted This bit is set depending on the R/W bit of the address byte, at the end of total address phase. It is also cleared by hardware after detection of Stop condition (STOPF=1), repeated Start condition, loss of bus arbitration (ARLO=1), or when PE=0. BUSY: Bus busy 0: No communication on the bus 1: Communication ongoing on the bus  Set by hardware on detection of SDA or SCL low  cleared by hardware on detection of a Stop condition. It indicates a communication in progress on the bus. This information is still updated when the interface is disabled (PE=0). MSL: Master/slave 0: Slave Mode 1: Master Mode  Set by hardware as soon as the interface is in Master mode (SB=1).  Cleared by hardware after detecting a Stop condition on the bus or a loss of arbitration (ARLO=1), or by hardware when PE=0 I2C_START_ERROR : if a timeout is passed without detecting a SB=1 then set an error condition to handle this error then reset the I2C and reconfigure it it could be the system is halt and need reset. <br  />
 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">I2CX</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t <br  />
 </dd></dl>
<p>I2C_CheckEvent(I2CX,I2C_EVENT_MASTER_MODE_SELECT))</p>

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00129">129</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  130</span>{</div>
<div class="line"><span class="lineno">  131</span>   <a class="code hl_variable" href="i2c-std_8c.html#afe83ed5d7df372f9dcd44526309ef239">I2Cx_Timeout</a>=<a class="code hl_define" href="i2c-std_8h.html#a52796b3a6cf92d6b16bf5e2164e65146">I2C_MAX_WAIT_TIME</a>;</div>
<div class="line"><span class="lineno">  132</span>    <span class="comment">//wait the event I2C_EVENT_MASTER_MODE_SELECT where BUSY, MSL and SB flag are set  (At EV5)</span></div>
<div class="line"><span class="lineno">  133</span>    <span class="comment">//EV5: at the  SB=1, cleared by reading SR1 register followed by writing the DR register.</span></div>
<div class="line"><span class="lineno">  135</span><span class="comment"></span>   <span class="keywordflow">while</span>(<a class="code hl_define" href="basic_8h.html#aa239d38020eac3ff2bea1a5e1c30c5a9">bits_is_clear</a>(I2CX-&gt;SR1,I2C_SR1_SB)|| </div>
<div class="line"><span class="lineno">  136</span>         <a class="code hl_define" href="basic_8h.html#aa239d38020eac3ff2bea1a5e1c30c5a9">bits_is_clear</a>(I2CX-&gt;SR2,(uint16_t)(I2C_SR2_BUSY | I2C_SR2_MSL)) ) </div>
<div class="line"><span class="lineno">  137</span>    {     </div>
<div class="line"><span class="lineno">  138</span>        <span class="comment">//   while(_I2C_GET_FLAG(I2CX,I2C_SR1_SB)==RESET   ||</span></div>
<div class="line"><span class="lineno">  139</span>        <span class="comment">//         _I2C_GET_FLAG(I2CX,I2C_SR2_BUSY)==RESET ||</span></div>
<div class="line"><span class="lineno">  140</span>        <span class="comment">//         _I2C_GET_FLAG(I2CX,I2C_SR2_MSL)==RESET  )</span></div>
<div class="line"><span class="lineno">  141</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="i2c-std_8c.html#afe83ed5d7df372f9dcd44526309ef239">I2Cx_Timeout</a>==0)  </div>
<div class="line"><span class="lineno">  142</span>      {</div>
<div class="line"><span class="lineno">  143</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="group__Exported__macros.html#ga822bb1bb9710d5f2fa6396b84e583c33">READ_BIT</a>(I2CX-&gt;CR1, I2C_CR1_START) == I2C_CR1_START)</div>
<div class="line"><span class="lineno">  144</span>        {</div>
<div class="line"><span class="lineno">  145</span>          <span class="keywordflow">return</span>  <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019af57f07115fa9068f8453b92a636c69ee">I2C_START_ERROR</a> ; <span class="comment">// set the error then exit :: I2C_START_CONDITION_ERROR :</span></div>
<div class="line"><span class="lineno">  146</span>        }</div>
<div class="line"><span class="lineno">  147</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a1056d6a4b037e383132309c2898a2fc8">I2C_TIMEOUT</a> ;        </div>
<div class="line"><span class="lineno">  148</span>      }   </div>
<div class="line"><span class="lineno">  149</span>    }</div>
<div class="line"><span class="lineno">  150</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;  </div>
<div class="line"><span class="lineno">  151</span>}</div>
<div class="ttc" id="agroup__Exported__macros_html_ga822bb1bb9710d5f2fa6396b84e583c33"><div class="ttname"><a href="group__Exported__macros.html#ga822bb1bb9710d5f2fa6396b84e583c33">READ_BIT</a></div><div class="ttdeci">#define READ_BIT(REG, BIT)</div><div class="ttdef"><b>Definition:</b> <a href="init-macro_8h_source.html#l00018">init-macro.h:18</a></div></div>
<div class="ttc" id="ai2c-std_8h_html_ac8daa3f8c12741492c20cf528dbb2019af57f07115fa9068f8453b92a636c69ee"><div class="ttname"><a href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019af57f07115fa9068f8453b92a636c69ee">I2C_START_ERROR</a></div><div class="ttdeci">@ I2C_START_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8h_source.html#l00066">i2c-std.h:66</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic_8h_source.html#l00055">bits_is_clear</a>, <a class="el" href="i2c-std_8h_source.html#l00027">I2C_MAX_WAIT_TIME</a>, <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, <a class="el" href="i2c-std_8h_source.html#l00066">I2C_START_ERROR</a>, <a class="el" href="i2c-std_8h_source.html#l00061">I2C_TIMEOUT</a>, <a class="el" href="i2c-std_8c_source.html#l00051">I2Cx_Timeout</a>, and <a class="el" href="init-macro_8h_source.html#l00018">READ_BIT</a>.</p>

<p class="reference">Referenced by <a class="el" href="i2c-std_8c_source.html#l00564">i2c_start_std()</a>.</p>

</div>
</div>
<a id="af2c67f3e11cf30f0a8ca085d89fa0bd1" name="af2c67f3e11cf30f0a8ca085d89fa0bd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2c67f3e11cf30f0a8ca085d89fa0bd1">&#9670;&#160;</a></span>i2c_wait_stop_event_std()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_wait_stop_event_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>wait start condition is complete SB=1 </p>
<p>wait the until the stop condidtion is completed</p>
<p>check that the stop condition is finished by checking the flag STOPF=1 Master-Transmitter Mode: EV8_2: TxE=1, BTF = 1, Program Stop request. TxE and BTF are cleared by hardware by the Stop condition Master-receiver Mode: -N&gt; 2 EV7: RxNE=1, cleared by reading DR register EV7_2: BTF = 1, DataN-2 in DR and DataN-1 in shift register, program ACK = 0, Read DataN-2 in DR.Program STOP = 1, read DataN-1. After the Stop condition generation, the interface goes automatically back to slave mode (MSL bit cleared). -N=2 EV7_3: BTF = 1, program STOP = 1, read DR twice (Read Data1 and Data2) just after programming the STOP. <br  />
 STOPF:  Set by hardware when a Stop condition is detected on the bus by the slave after an acknowledge (if ACK=1).  Cleared by software reading the SR1 register followed by a write in the CR1 register, or by hardware when PE=0 Note 1: The STOPF bit is not set after a NACK reception. Note 2: It is recommended to perform the complete clearing sequence (READ SR1 then WRITE CR1) after the STOPF is set. Note 3: at the end of any I2C bus transaction checking the STOPF --&gt; SR1 is read as each new start I2C bus transaction will always start (after checking BUSY) by generating start condition --&gt; CR1 is written therefore actually after each startcondition generation the STOPF will be reset by the software implicitly <br  />
</p>
<p>I2C_STOP_ERROR: if a timeout is passed without detecting a STOPF=1 then set an error condition to handle this error then reset the I2C and reconfigure it it could be the system is halt and need reset. <br  />
 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">I2CX</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t <br  />
 </dd></dl>

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00183">183</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  184</span>{</div>
<div class="line"><span class="lineno">  185</span>  <a class="code hl_variable" href="i2c-std_8c.html#afe83ed5d7df372f9dcd44526309ef239">I2Cx_Timeout</a>=<a class="code hl_define" href="i2c-std_8h.html#a52796b3a6cf92d6b16bf5e2164e65146">I2C_MAX_WAIT_TIME</a>;  </div>
<div class="line"><span class="lineno">  186</span>  <span class="comment">// wait until stop condition is complete STOPF is set</span></div>
<div class="line"><span class="lineno">  187</span>  <span class="keywordflow">while</span>(<a class="code hl_define" href="basic_8h.html#a793bbd5374ca9d6747044316c4ef9e0e">bits_is_set</a>(I2CX-&gt;SR2,I2C_SR2_MSL))<span class="comment">//I2Cx_Timeout&gt;0)//bit_is_clear(I2CX-&gt;SR1,I2C_SR1_STOPF) &amp;&amp; )//I2C_GetFlagStatus(I2CX,I2C_FLAG_STOPF))</span></div>
<div class="line"><span class="lineno">  188</span>   {   </div>
<div class="line"><span class="lineno">  189</span>        <span class="comment">/* Generate Stop */</span></div>
<div class="line"><span class="lineno">  190</span>        <span class="comment">//SET_BIT(I2CX-&gt;CR1, I2C_CR1_STOP);</span></div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>      <span class="comment">/* Check if a STOPF is detected */</span></div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>      <span class="keywordflow">if</span> (<a class="code hl_define" href="basic_8h.html#a793bbd5374ca9d6747044316c4ef9e0e">bits_is_set</a>(I2CX-&gt;SR1,I2C_SR1_STOPF) )</div>
<div class="line"><span class="lineno">  195</span>      {</div>
<div class="line"><span class="lineno">  196</span>          <span class="comment">/* Clear STOP Flag */</span></div>
<div class="line"><span class="lineno">  197</span>          <a class="code hl_define" href="i2c-std_8h.html#a62afbe99c26993afbe1591724d797422">_I2C_CLEAR_STOPFLAG</a>(I2CX);      </div>
<div class="line"><span class="lineno">  198</span>          <span class="keywordflow">return</span> 0x40;<span class="comment">//I2C_OK;</span></div>
<div class="line"><span class="lineno">  199</span>      }</div>
<div class="line"><span class="lineno">  200</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="i2c-std_8c.html#afe83ed5d7df372f9dcd44526309ef239">I2Cx_Timeout</a>==0)  </div>
<div class="line"><span class="lineno">  201</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a1e37a71cafdab3edf4e7c685833016ad">I2C_STOP_ERROR</a>;</div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span>   }  </div>
<div class="line"><span class="lineno">  204</span>   <span class="comment">//if(I2Cx_Timeout==0)  </span></div>
<div class="line"><span class="lineno">  205</span>    <span class="comment">//return I2C_STOP_ERROR;</span></div>
<div class="line"><span class="lineno">  206</span>    <span class="comment">// CLEAR_BIT(I2CX-&gt;CR1,I2C_CR1_PE);   //cbits(I2CX-&gt;CR1,I2C_CR1_PE);</span></div>
<div class="line"><span class="lineno">  207</span>    <span class="comment">// asm(&quot;nop&quot;);</span></div>
<div class="line"><span class="lineno">  208</span>    <span class="comment">// asm(&quot;nop&quot;);</span></div>
<div class="line"><span class="lineno">  209</span>    <span class="comment">// asm(&quot;nop&quot;);</span></div>
<div class="line"><span class="lineno">  210</span>    <span class="comment">// SET_BIT(I2CX-&gt;CR1,I2C_CR1_PE);</span></div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>      <span class="comment">//return I2C_STOP_ERROR;</span></div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>    <span class="comment">//sbits(I2CX-&gt;CR1,I2C_CR1_PE);</span></div>
<div class="line"><span class="lineno">  215</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;</div>
<div class="line"><span class="lineno">  216</span>}</div>
<div class="ttc" id="ai2c-std_8h_html_ac8daa3f8c12741492c20cf528dbb2019a1e37a71cafdab3edf4e7c685833016ad"><div class="ttname"><a href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a1e37a71cafdab3edf4e7c685833016ad">I2C_STOP_ERROR</a></div><div class="ttdeci">@ I2C_STOP_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8h_source.html#l00067">i2c-std.h:67</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="i2c-std_8h_source.html#l00122">_I2C_CLEAR_STOPFLAG</a>, <a class="el" href="basic_8h_source.html#l00054">bits_is_set</a>, <a class="el" href="i2c-std_8h_source.html#l00027">I2C_MAX_WAIT_TIME</a>, <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, <a class="el" href="i2c-std_8h_source.html#l00067">I2C_STOP_ERROR</a>, and <a class="el" href="i2c-std_8c_source.html#l00051">I2Cx_Timeout</a>.</p>

<p class="reference">Referenced by <a class="el" href="i2c-std_8c_source.html#l01288">i2c_read_7bit_base_nbyte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l01039">i2c_read_7bit_nbyte_std()</a>, and <a class="el" href="i2c-std_8c_source.html#l00587">i2c_stop_std()</a>.</p>

</div>
</div>
<a id="a61e492ed3801f4840acd13e83240afcb" name="a61e492ed3801f4840acd13e83240afcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61e492ed3801f4840acd13e83240afcb">&#9670;&#160;</a></span>i2c_wait_write_byte_btf_std()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_wait_write_byte_btf_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>wait the complete of current byte transmition (MASTER-write) </p>
<p>Waits the until the complete transmistion of the current data byte.</p>
<p>check that the complete transmistion of the current data byte has completed by checking the flag BTF EV8_1: TxE=1,BTF=1, shift register empty, data register empty, write Data1 in DR. EV8 : TxE=1,BTF=0, shift register not empty, .data register empty, cleared by writing DR register BTF: Byte transfer finished 0: Data byte transfer not done 1: Data byte transfer succeeded  Set by hardware when NOSTRETCH=0 and:  In reception when a new byte is received (including ACK pulse) and DR has not been read yet (RxNE=1).  In transmission when a new byte should be sent and DR has not been written yet (TxE=1).  Cleared by software reading SR1 followed by either a read or write in the DR register or by</p><ul>
<li>Cleared by hardware after a start or a stop condition in transmission or when PE=0. Note: The BTF bit is not set after a NACK reception</li>
</ul>
<p>I2C_TX_BYTE_ERROR: if a timeout is passed without detecting a BTF=1 then set an error condition <br  />
 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">I2CX</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t <br  />
 </dd></dl>
<p>wait the complete of current byte transmition (MASTER-write)</p>
<p>I2C_GetFlagStatus(I2CX,I2C_FLAG_TXE))</p>

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00398">398</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  399</span>{</div>
<div class="line"><span class="lineno">  401</span>    <a class="code hl_variable" href="i2c-std_8c.html#afe83ed5d7df372f9dcd44526309ef239">I2Cx_Timeout</a>=<a class="code hl_define" href="i2c-std_8h.html#a52796b3a6cf92d6b16bf5e2164e65146">I2C_MAX_WAIT_TIME</a>; </div>
<div class="line"><span class="lineno">  402</span>    <span class="comment">//volatile uint32_t Timeout=0xffff;</span></div>
<div class="line"><span class="lineno">  403</span>    <span class="comment">//Wait until BTF is set</span></div>
<div class="line"><span class="lineno">  404</span>    <span class="comment">// each time just repeat Ev8_1 &amp; Ev8 : shift register empty, data register empty, and need to write to DR register</span></div>
<div class="line"><span class="lineno">  405</span>    <span class="keywordflow">while</span>(<a class="code hl_define" href="basic_8h.html#aa239d38020eac3ff2bea1a5e1c30c5a9">bits_is_clear</a>(I2CX-&gt;SR1,I2C_SR1_BTF)) </div>
<div class="line"><span class="lineno">  406</span>    {</div>
<div class="line"><span class="lineno">  407</span>        <span class="keywordflow">if</span>(<a class="code hl_define" href="basic_8h.html#a793bbd5374ca9d6747044316c4ef9e0e">bits_is_set</a>(I2CX-&gt;SR1,I2C_SR1_AF))  </div>
<div class="line"><span class="lineno">  408</span>        {</div>
<div class="line"><span class="lineno">  409</span>         <span class="comment">/* Generate Stop */</span></div>
<div class="line"><span class="lineno">  410</span>         <a class="code hl_define" href="group__Exported__macros.html#ga26474f43799fbade9cf300e21dd3a91a">SET_BIT</a>(I2CX-&gt;CR1, I2C_CR1_STOP);</div>
<div class="line"><span class="lineno">  411</span>        <span class="comment">/* Clear AF Flag */</span></div>
<div class="line"><span class="lineno">  412</span>         <a class="code hl_define" href="group__Exported__macros.html#ga133aae6fc0d41bffab39ab223a7001de">CLEAR_BIT</a>(I2CX-&gt;SR1,I2C_FLAG_AF);  <span class="comment">//_I2C_CLEAR_FLAG(hi2c, I2C_FLAG_AF);</span></div>
<div class="line"><span class="lineno">  413</span>        </div>
<div class="line"><span class="lineno">  414</span>        <span class="comment">// I2C_SLAVE_ADDRESS_NACK Acknowledge no slave with this address at the bus</span></div>
<div class="line"><span class="lineno">  415</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a3c2a9f4442f725c4c67e42910f0ba7e8">I2C_NACK_ERROR</a>;</div>
<div class="line"><span class="lineno">  416</span>       }</div>
<div class="line"><span class="lineno">  417</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="i2c-std_8c.html#afe83ed5d7df372f9dcd44526309ef239">I2Cx_Timeout</a>==0)</div>
<div class="line"><span class="lineno">  418</span>        <span class="keywordflow">return</span>  <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a8977371aa7afe1b3bc0d40104eab0a06">I2C_TX_BTF_ERROR</a>;<span class="comment">// set the error then exit ::I2C_TX_BTF_ERROR</span></div>
<div class="line"><span class="lineno">  419</span>   }</div>
<div class="line"><span class="lineno">  420</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;</div>
<div class="line"><span class="lineno">  421</span>}</div>
<div class="ttc" id="ai2c-std_8h_html_ac8daa3f8c12741492c20cf528dbb2019a8977371aa7afe1b3bc0d40104eab0a06"><div class="ttname"><a href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a8977371aa7afe1b3bc0d40104eab0a06">I2C_TX_BTF_ERROR</a></div><div class="ttdeci">@ I2C_TX_BTF_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8h_source.html#l00070">i2c-std.h:70</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic_8h_source.html#l00055">bits_is_clear</a>, <a class="el" href="basic_8h_source.html#l00054">bits_is_set</a>, <a class="el" href="init-macro_8h_source.html#l00016">CLEAR_BIT</a>, <a class="el" href="i2c-std_8h_source.html#l00027">I2C_MAX_WAIT_TIME</a>, <a class="el" href="i2c-std_8h_source.html#l00068">I2C_NACK_ERROR</a>, <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, <a class="el" href="i2c-std_8h_source.html#l00070">I2C_TX_BTF_ERROR</a>, <a class="el" href="i2c-std_8c_source.html#l00051">I2Cx_Timeout</a>, and <a class="el" href="init-macro_8h_source.html#l00014">SET_BIT</a>.</p>

</div>
</div>
<a id="a09766e33b0b082d13065b3e03e2bb6d3" name="a09766e33b0b082d13065b3e03e2bb6d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09766e33b0b082d13065b3e03e2bb6d3">&#9670;&#160;</a></span>i2c_wait_write_byte_txe_std()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_wait_write_byte_txe_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>wait the slave address acknowledge Master_Read </p>
<p>Waits the until the complete transmistion of the current data byte.</p>
<p>check that the complete transmistion of the current data byte has completed by checking the flag BTF EV8_1: TxE=1,BTF=1, shift register empty, data register empty, write Data1 in DR. EV8 : TxE=1,BTF=0, shift register not empty, .data register empty, cleared by writing DR register BTF: Byte transfer finished 0: Data byte transfer not done 1: Data byte transfer succeeded  Set by hardware when NOSTRETCH=0 and:  In reception when a new byte is received (including ACK pulse) and DR has not been read yet (RxNE=1).  In transmission when a new byte should be sent and DR has not been written yet (TxE=1).  Cleared by software reading SR1 followed by either a read or write in the DR register or by</p><ul>
<li>Cleared by hardware after a start or a stop condition in transmission or when PE=0. Note: The BTF bit is not set after a NACK reception</li>
</ul>
<p>I2C_TX_BYTE_ERROR: if a timeout is passed without detecting a BTF=1 then set an error condition <br  />
 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">I2CX</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t <br  />
 </dd></dl>
<p>wait the complete of current byte transmition (MASTER-write)</p>
<p>I2C_GetFlagStatus(I2CX,I2C_FLAG_TXE))</p>

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00444">444</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  445</span>{</div>
<div class="line"><span class="lineno">  447</span>    <a class="code hl_variable" href="i2c-std_8c.html#afe83ed5d7df372f9dcd44526309ef239">I2Cx_Timeout</a>=<a class="code hl_define" href="i2c-std_8h.html#a52796b3a6cf92d6b16bf5e2164e65146">I2C_MAX_WAIT_TIME</a>; </div>
<div class="line"><span class="lineno">  448</span>    <span class="comment">//volatile uint32_t Timeout=0xffff;</span></div>
<div class="line"><span class="lineno">  449</span>    <span class="comment">//Wait until BTF is set</span></div>
<div class="line"><span class="lineno">  450</span>    <span class="comment">// each time just repeat Ev8_1 &amp; Ev8 : shift register empty, data register empty, and need to write to DR register</span></div>
<div class="line"><span class="lineno">  451</span>    <span class="keywordflow">while</span>(<a class="code hl_define" href="basic_8h.html#aa239d38020eac3ff2bea1a5e1c30c5a9">bits_is_clear</a>(I2CX-&gt;SR1,I2C_SR1_TXE)) </div>
<div class="line"><span class="lineno">  452</span>    {</div>
<div class="line"><span class="lineno">  453</span>        <span class="keywordflow">if</span>(<a class="code hl_define" href="basic_8h.html#a793bbd5374ca9d6747044316c4ef9e0e">bits_is_set</a>(I2CX-&gt;SR1,I2C_SR1_AF))  </div>
<div class="line"><span class="lineno">  454</span>        {</div>
<div class="line"><span class="lineno">  455</span>           <span class="comment">/* Generate Stop */</span></div>
<div class="line"><span class="lineno">  456</span>            <a class="code hl_define" href="group__Exported__macros.html#ga26474f43799fbade9cf300e21dd3a91a">SET_BIT</a>(I2CX-&gt;CR1, I2C_CR1_STOP);</div>
<div class="line"><span class="lineno">  457</span>          <span class="comment">/* Clear AF Flag */</span></div>
<div class="line"><span class="lineno">  458</span>            <a class="code hl_define" href="group__Exported__macros.html#ga133aae6fc0d41bffab39ab223a7001de">CLEAR_BIT</a>(I2CX-&gt;SR1,I2C_FLAG_AF);  <span class="comment">//_I2C_CLEAR_FLAG(hi2c, I2C_FLAG_AF);</span></div>
<div class="line"><span class="lineno">  459</span>          <span class="comment">// I2C_SLAVE_ADDRESS_NACK Acknowledge no slave with this address at the bus</span></div>
<div class="line"><span class="lineno">  460</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a3c2a9f4442f725c4c67e42910f0ba7e8">I2C_NACK_ERROR</a>;</div>
<div class="line"><span class="lineno">  461</span>        }</div>
<div class="line"><span class="lineno">  462</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="i2c-std_8c.html#afe83ed5d7df372f9dcd44526309ef239">I2Cx_Timeout</a>==0)</div>
<div class="line"><span class="lineno">  463</span>          <span class="keywordflow">return</span>  <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a5eaa8b05c083ac88b9473f5748d9a2ea">I2C_TX_TXE_ERROR</a>; <span class="comment">// set the error then exit ::I2C_TX_BTF_ERROR</span></div>
<div class="line"><span class="lineno">  464</span>    }</div>
<div class="line"><span class="lineno">  465</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;</div>
<div class="line"><span class="lineno">  466</span>}</div>
<div class="ttc" id="ai2c-std_8h_html_ac8daa3f8c12741492c20cf528dbb2019a5eaa8b05c083ac88b9473f5748d9a2ea"><div class="ttname"><a href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019a5eaa8b05c083ac88b9473f5748d9a2ea">I2C_TX_TXE_ERROR</a></div><div class="ttdeci">@ I2C_TX_TXE_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8h_source.html#l00071">i2c-std.h:71</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic_8h_source.html#l00055">bits_is_clear</a>, <a class="el" href="basic_8h_source.html#l00054">bits_is_set</a>, <a class="el" href="init-macro_8h_source.html#l00016">CLEAR_BIT</a>, <a class="el" href="i2c-std_8h_source.html#l00027">I2C_MAX_WAIT_TIME</a>, <a class="el" href="i2c-std_8h_source.html#l00068">I2C_NACK_ERROR</a>, <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, <a class="el" href="i2c-std_8h_source.html#l00071">I2C_TX_TXE_ERROR</a>, <a class="el" href="i2c-std_8c_source.html#l00051">I2Cx_Timeout</a>, and <a class="el" href="init-macro_8h_source.html#l00014">SET_BIT</a>.</p>

<p class="reference">Referenced by <a class="el" href="i2c-std_8c_source.html#l00602">i2c_send_7bit_slave_address_wr_std()</a>, and <a class="el" href="i2c-std_8c_source.html#l00653">i2c_write_byte_std()</a>.</p>

</div>
</div>
<a id="a527f91d19871a248cda4f434094d5d8e" name="a527f91d19871a248cda4f434094d5d8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a527f91d19871a248cda4f434094d5d8e">&#9670;&#160;</a></span>i2c_write_7bit_base_byte_std()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_write_7bit_base_byte_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slave_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>base_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l01078">1078</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1079</span>{</div>
<div class="line"><span class="lineno"> 1080</span> </div>
<div class="line"><span class="lineno"> 1081</span> <span class="comment">// get the result of any sub operation where a non-zero value indicates an error condition</span></div>
<div class="line"><span class="lineno"> 1082</span>    uint8_t error=0; </div>
<div class="line"><span class="lineno"> 1083</span>  <span class="comment">//uart_print(USART1,&quot;\nTX_BuSY ...\r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1084</span>  <span class="comment">//wait check that the I2c module is not busy</span></div>
<div class="line"><span class="lineno"> 1085</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#af1e961a5d80b477de6216bae4fd1a13c">i2c_ready_std</a>(I2CX)))</div>
<div class="line"><span class="lineno"> 1086</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1087</span>    </div>
<div class="line"><span class="lineno"> 1088</span>  <span class="comment">//uart_print(USART1,&quot;TX_SB ...\r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1089</span>  <span class="comment">// send the start condition </span></div>
<div class="line"><span class="lineno"> 1090</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#ab94774de700d4b23afd5fdeb2e7bd720">i2c_start_std</a>(I2CX))) </div>
<div class="line"><span class="lineno"> 1091</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1092</span> </div>
<div class="line"><span class="lineno"> 1093</span>   <span class="comment">//uart_print(USART1,&quot;TX_SLAVE_ADDR ...\r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1094</span>    <span class="comment">//EV5: send the slave address with write operation master transmit </span></div>
<div class="line"><span class="lineno"> 1095</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#ad8d46b2367148047111a79daa00a9ca2">i2c_send_7bit_slave_address_wr_std</a>(I2CX,slave_address)))</div>
<div class="line"><span class="lineno"> 1096</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1097</span><span class="comment">//      (void) I2CX -&gt;SR1;</span></div>
<div class="line"><span class="lineno"> 1098</span><span class="comment">//      (void) I2CX -&gt;SR2; // Clear ADDR flag</span></div>
<div class="line"><span class="lineno"> 1099</span> </div>
<div class="line"><span class="lineno"> 1100</span>   <span class="comment">//uart_print(USART1,&quot;TX_BASE_ADDR ...\r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1101</span>    <span class="comment">//Ev6: send the byte :: the base address in the slave Memory/register map to start writing to </span></div>
<div class="line"><span class="lineno"> 1102</span>    <a class="code hl_function" href="i2c-std_8c.html#a020e948eaa99407ff2ffead770cbe3f2">i2c_write_byte_std</a>(I2CX,base_address);</div>
<div class="line"><span class="lineno"> 1103</span>    <span class="comment">//if((error=i2c_write_byte_std(I2CX,base_address)))</span></div>
<div class="line"><span class="lineno"> 1104</span>    <span class="comment">//    return error;</span></div>
<div class="line"><span class="lineno"> 1105</span> </div>
<div class="line"><span class="lineno"> 1106</span>      <span class="comment">//cbits(I2CX-&gt;SR1,I2C_SR1_AF);</span></div>
<div class="line"><span class="lineno"> 1107</span> </div>
<div class="line"><span class="lineno"> 1108</span>   <span class="comment">//uart_print(USART1,&quot;TX_REG_DATA ...\r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1109</span>    <span class="comment">//Ev6: send the byte</span></div>
<div class="line"><span class="lineno"> 1110</span>    <a class="code hl_function" href="i2c-std_8c.html#a020e948eaa99407ff2ffead770cbe3f2">i2c_write_byte_std</a>(I2CX,data);</div>
<div class="line"><span class="lineno"> 1111</span>    <span class="comment">//if((error=i2c_write_byte_std(I2CX,data))) </span></div>
<div class="line"><span class="lineno"> 1112</span>    <span class="comment">//    return error;</span></div>
<div class="line"><span class="lineno"> 1113</span>     <span class="comment">// cbits(I2CX-&gt;SR1,I2C_SR1_AF);</span></div>
<div class="line"><span class="lineno"> 1114</span> </div>
<div class="line"><span class="lineno"> 1115</span>   <span class="comment">//uart_print(USART1,&quot;TX_STOP ...\r\n&quot;);</span></div>
<div class="line"><span class="lineno"> 1116</span>    <span class="comment">// generate the stop condition </span></div>
<div class="line"><span class="lineno"> 1117</span>    <a class="code hl_function" href="i2c-std_8c.html#a148f10682cf5ebeb939bbed609a54ac9">i2c_stop_std</a>(I2CX);</div>
<div class="line"><span class="lineno"> 1118</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#a148f10682cf5ebeb939bbed609a54ac9">i2c_stop_std</a>(I2CX)))</div>
<div class="line"><span class="lineno"> 1119</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1120</span> </div>
<div class="line"><span class="lineno"> 1121</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;</div>
<div class="line"><span class="lineno"> 1122</span>}</div>
<div class="ttc" id="ai2c-std_8c_html_a148f10682cf5ebeb939bbed609a54ac9"><div class="ttname"><a href="i2c-std_8c.html#a148f10682cf5ebeb939bbed609a54ac9">i2c_stop_std</a></div><div class="ttdeci">static uint8_t i2c_stop_std(I2C_TypeDef *I2CX)</div><div class="ttdoc">initiate start condition</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8c_source.html#l00587">i2c-std.c:587</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, <a class="el" href="i2c-std_8c_source.html#l00077">i2c_ready_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00602">i2c_send_7bit_slave_address_wr_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00564">i2c_start_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00587">i2c_stop_std()</a>, and <a class="el" href="i2c-std_8c_source.html#l00653">i2c_write_byte_std()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mpu6050_8c_source.html#l00370">mpu6050_DisableInterrupts()</a>, <a class="el" href="mpu6050_8c_source.html#l00514">mpu6050_enableCycle()</a>, <a class="el" href="mpu6050_8c_source.html#l00347">mpu6050_EnableInterrupts()</a>, <a class="el" href="mpu6050_8c_source.html#l00502">mpu6050_enableSleep()</a>, <a class="el" href="mpu6050_8c_source.html#l00219">mpu6050_reset()</a>, <a class="el" href="mpu6050_8c_source.html#l00572">mpu6050_set_hpf()</a>, <a class="el" href="mpu6050_8c_source.html#l00544">mpu6050_set_lpf()</a>, <a class="el" href="mpu6050_8c_source.html#l00676">mpu6050_setAccelerometerStandby()</a>, <a class="el" href="mpu6050_8c_source.html#l00444">mpu6050_setAccelRange()</a>, <a class="el" href="mpu6050_8c_source.html#l00490">mpu6050_setCycleRate()</a>, <a class="el" href="mpu6050_8c_source.html#l00480">mpu6050_setDataRate()</a>, <a class="el" href="mpu6050_8c_source.html#l00412">mpu6050_setGyroRange()</a>, <a class="el" href="mpu6050_8c_source.html#l00663">mpu6050_setGyroStandby()</a>, <a class="el" href="mpu6050_8c_source.html#l00526">mpu6050_setI2CBypass()</a>, <a class="el" href="mpu6050_8c_source.html#l00485">mpu6050_setSampleRateDivisor()</a>, and <a class="el" href="mpu6050_8c_source.html#l00689">mpu6050_setTemperatureStandby()</a>.</p>

</div>
</div>
<a id="a92a337a422e0b3d11c2a7e58cd251653" name="a92a337a422e0b3d11c2a7e58cd251653"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92a337a422e0b3d11c2a7e58cd251653">&#9670;&#160;</a></span>i2c_write_7bit_base_nbyte_std()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_write_7bit_base_nbyte_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slave_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>base_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l01124">1124</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1125</span>{</div>
<div class="line"><span class="lineno"> 1126</span> <span class="comment">// get the error of the any sub operation where a non-zero value indicate an error </span></div>
<div class="line"><span class="lineno"> 1127</span>  uint8_t error=0; </div>
<div class="line"><span class="lineno"> 1128</span> </div>
<div class="line"><span class="lineno"> 1129</span>  <span class="comment">//wait check that the I2c module is not busy</span></div>
<div class="line"><span class="lineno"> 1130</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#af1e961a5d80b477de6216bae4fd1a13c">i2c_ready_std</a>(I2CX))) </div>
<div class="line"><span class="lineno"> 1131</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1132</span>  <span class="comment">// send the start condition </span></div>
<div class="line"><span class="lineno"> 1133</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#ab94774de700d4b23afd5fdeb2e7bd720">i2c_start_std</a>(I2CX)))</div>
<div class="line"><span class="lineno"> 1134</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1135</span> </div>
<div class="line"><span class="lineno"> 1136</span>    <span class="comment">//EV5: send the slave address with write operation master transmit </span></div>
<div class="line"><span class="lineno"> 1137</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#ad8d46b2367148047111a79daa00a9ca2">i2c_send_7bit_slave_address_wr_std</a>(I2CX,slave_address)))</div>
<div class="line"><span class="lineno"> 1138</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1139</span> </div>
<div class="line"><span class="lineno"> 1140</span>    <span class="comment">//Ev6: send the byte :: the base address in the slave Memory/register map to start writing to </span></div>
<div class="line"><span class="lineno"> 1141</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#a020e948eaa99407ff2ffead770cbe3f2">i2c_write_byte_std</a>(I2CX,base_address))) </div>
<div class="line"><span class="lineno"> 1142</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1143</span> </div>
<div class="line"><span class="lineno"> 1144</span>    <span class="comment">//Ev6: send the byte</span></div>
<div class="line"><span class="lineno"> 1145</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#ac853a425783ac34982c6f94cd081013f">i2c_write_nbyte_std</a>(I2CX,buf,n))) </div>
<div class="line"><span class="lineno"> 1146</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1147</span> </div>
<div class="line"><span class="lineno"> 1148</span>    <span class="comment">// generate the stop condition </span></div>
<div class="line"><span class="lineno"> 1149</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#a148f10682cf5ebeb939bbed609a54ac9">i2c_stop_std</a>(I2CX))) </div>
<div class="line"><span class="lineno"> 1150</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1151</span> </div>
<div class="line"><span class="lineno"> 1152</span>    <span class="comment">// all operation has succeeded no error to return </span></div>
<div class="line"><span class="lineno"> 1153</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1154</span> </div>
<div class="line"><span class="lineno"> 1155</span>}</div>
<div class="ttc" id="ai2c-std_8c_html_ac853a425783ac34982c6f94cd081013f"><div class="ttname"><a href="i2c-std_8c.html#ac853a425783ac34982c6f94cd081013f">i2c_write_nbyte_std</a></div><div class="ttdeci">static uint8_t i2c_write_nbyte_std(I2C_TypeDef *I2CX, uint8_t *buf, size_t n)</div><div class="ttdoc">send a byte via I2C bus</div><div class="ttdef"><b>Definition:</b> <a href="i2c-std_8c_source.html#l00670">i2c-std.c:670</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="i2c-std_8c_source.html#l00077">i2c_ready_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00602">i2c_send_7bit_slave_address_wr_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00564">i2c_start_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00587">i2c_stop_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00653">i2c_write_byte_std()</a>, and <a class="el" href="i2c-std_8c_source.html#l00670">i2c_write_nbyte_std()</a>.</p>

</div>
</div>
<a id="a8257b586d43b7046f5bc18e6b226e36b" name="a8257b586d43b7046f5bc18e6b226e36b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8257b586d43b7046f5bc18e6b226e36b">&#9670;&#160;</a></span>i2c_write_7bit_byte_std()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_write_7bit_byte_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slave_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00962">962</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  963</span>{</div>
<div class="line"><span class="lineno">  964</span> <span class="comment">// get the result of any sub operation where a non-zero value indicates an error condition</span></div>
<div class="line"><span class="lineno">  965</span>    uint8_t error=0; </div>
<div class="line"><span class="lineno">  966</span> </div>
<div class="line"><span class="lineno">  967</span>  <span class="comment">//wait check that the I2c module is not busy</span></div>
<div class="line"><span class="lineno">  968</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#af1e961a5d80b477de6216bae4fd1a13c">i2c_ready_std</a>(I2CX)))</div>
<div class="line"><span class="lineno">  969</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno">  970</span> </div>
<div class="line"><span class="lineno">  971</span>  <span class="comment">// send the start condition </span></div>
<div class="line"><span class="lineno">  972</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#ab94774de700d4b23afd5fdeb2e7bd720">i2c_start_std</a>(I2CX)))</div>
<div class="line"><span class="lineno">  973</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno">  974</span> </div>
<div class="line"><span class="lineno">  975</span>    <span class="comment">//EV5: send the slave address with write operation master transmit </span></div>
<div class="line"><span class="lineno">  976</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#ad8d46b2367148047111a79daa00a9ca2">i2c_send_7bit_slave_address_wr_std</a>(I2CX,slave_address)))</div>
<div class="line"><span class="lineno">  977</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno">  978</span> </div>
<div class="line"><span class="lineno">  979</span>    <span class="comment">//Ev6: send the byte</span></div>
<div class="line"><span class="lineno">  980</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#a020e948eaa99407ff2ffead770cbe3f2">i2c_write_byte_std</a>(I2CX,data)))</div>
<div class="line"><span class="lineno">  981</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno">  982</span> </div>
<div class="line"><span class="lineno">  983</span>    <span class="comment">// generate the stop condition </span></div>
<div class="line"><span class="lineno">  984</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#a148f10682cf5ebeb939bbed609a54ac9">i2c_stop_std</a>(I2CX)))</div>
<div class="line"><span class="lineno">  985</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno">  986</span> </div>
<div class="line"><span class="lineno">  987</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;</div>
<div class="line"><span class="lineno">  988</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, <a class="el" href="i2c-std_8c_source.html#l00077">i2c_ready_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00602">i2c_send_7bit_slave_address_wr_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00564">i2c_start_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00587">i2c_stop_std()</a>, and <a class="el" href="i2c-std_8c_source.html#l00653">i2c_write_byte_std()</a>.</p>

</div>
</div>
<a id="a4e6fc14e4ed62373119bf4174fd43707" name="a4e6fc14e4ed62373119bf4174fd43707"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e6fc14e4ed62373119bf4174fd43707">&#9670;&#160;</a></span>i2c_write_7bit_nbyte_std()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_write_7bit_nbyte_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slave_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00990">990</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  991</span>{</div>
<div class="line"><span class="lineno">  992</span> <span class="comment">// get the error of the any sub operation where a non-zero value indicate an error </span></div>
<div class="line"><span class="lineno">  993</span>  uint8_t error=0; </div>
<div class="line"><span class="lineno">  994</span> </div>
<div class="line"><span class="lineno">  995</span>  <span class="comment">//wait check that the I2c module is not busy</span></div>
<div class="line"><span class="lineno">  996</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#af1e961a5d80b477de6216bae4fd1a13c">i2c_ready_std</a>(I2CX)))</div>
<div class="line"><span class="lineno">  997</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno">  998</span>  <span class="comment">// send the start condition </span></div>
<div class="line"><span class="lineno">  999</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#ab94774de700d4b23afd5fdeb2e7bd720">i2c_start_std</a>(I2CX)))</div>
<div class="line"><span class="lineno"> 1000</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1001</span> </div>
<div class="line"><span class="lineno"> 1002</span>    <span class="comment">//EV5: send the slave address with write operation master transmit </span></div>
<div class="line"><span class="lineno"> 1003</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#ad8d46b2367148047111a79daa00a9ca2">i2c_send_7bit_slave_address_wr_std</a>(I2CX,slave_address)))</div>
<div class="line"><span class="lineno"> 1004</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1005</span> </div>
<div class="line"><span class="lineno"> 1006</span>    <span class="comment">//Ev6: send the byte</span></div>
<div class="line"><span class="lineno"> 1007</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#ac853a425783ac34982c6f94cd081013f">i2c_write_nbyte_std</a>(I2CX,buf,n)))</div>
<div class="line"><span class="lineno"> 1008</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1009</span> </div>
<div class="line"><span class="lineno"> 1010</span>    <span class="comment">// generate the stop condition </span></div>
<div class="line"><span class="lineno"> 1011</span>    <span class="keywordflow">if</span>((error=<a class="code hl_function" href="i2c-std_8c.html#a148f10682cf5ebeb939bbed609a54ac9">i2c_stop_std</a>(I2CX)))</div>
<div class="line"><span class="lineno"> 1012</span>        <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno"> 1013</span> </div>
<div class="line"><span class="lineno"> 1014</span>    <span class="comment">// all operation has succeeded no error to return </span></div>
<div class="line"><span class="lineno"> 1015</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1016</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="i2c-std_8c_source.html#l00077">i2c_ready_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00602">i2c_send_7bit_slave_address_wr_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00564">i2c_start_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00587">i2c_stop_std()</a>, and <a class="el" href="i2c-std_8c_source.html#l00670">i2c_write_nbyte_std()</a>.</p>

</div>
</div>
<a id="a020e948eaa99407ff2ffead770cbe3f2" name="a020e948eaa99407ff2ffead770cbe3f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a020e948eaa99407ff2ffead770cbe3f2">&#9670;&#160;</a></span>i2c_write_byte_std()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_write_byte_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>send a slave with read operation via I2C bus </p>
<p>write a byte via TWI/I2C bus to the slave</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">I2CX</td><td></td></tr>
    <tr><td class="paramname">data</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t </dd></dl>
<p>I2C_SendData(I2CX,data); <br  />
</p>

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00653">653</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  654</span>{</div>
<div class="line"><span class="lineno">  655</span>    uint8_t error=0;</div>
<div class="line"><span class="lineno">  656</span>    <span class="comment">//Ev6: send the byte</span></div>
<div class="line"><span class="lineno">  657</span>      I2CX-&gt;DR=data;</div>
<div class="line"><span class="lineno">  658</span>    <span class="comment">//Wait until txe is set</span></div>
<div class="line"><span class="lineno">  659</span>    error=<a class="code hl_function" href="i2c-std_8c.html#a09766e33b0b082d13065b3e03e2bb6d3">i2c_wait_write_byte_txe_std</a>(I2CX);</div>
<div class="line"><span class="lineno">  660</span>    <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno">  661</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="i2c-std_8c_source.html#l00444">i2c_wait_write_byte_txe_std()</a>.</p>

<p class="reference">Referenced by <a class="el" href="i2c-std_8c_source.html#l01288">i2c_read_7bit_base_nbyte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l01078">i2c_write_7bit_base_byte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l01124">i2c_write_7bit_base_nbyte_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00962">i2c_write_7bit_byte_std()</a>, and <a class="el" href="i2c-std_8c_source.html#l00670">i2c_write_nbyte_std()</a>.</p>

</div>
</div>
<a id="ac853a425783ac34982c6f94cd081013f" name="ac853a425783ac34982c6f94cd081013f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac853a425783ac34982c6f94cd081013f">&#9670;&#160;</a></span>i2c_write_nbyte_std()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_write_nbyte_std </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>I2CX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>send a byte via I2C bus </p>
<p>write an array of n byte via TWI/I2C bus to the slave</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">I2CX</td><td></td></tr>
    <tr><td class="paramname">data</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t </dd></dl>

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00670">670</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  671</span>{</div>
<div class="line"><span class="lineno">  672</span>    uint16_t i=0;</div>
<div class="line"><span class="lineno">  673</span>    uint8_t error=0;</div>
<div class="line"><span class="lineno">  674</span>    <span class="comment">//Ev6: send the byte</span></div>
<div class="line"><span class="lineno">  675</span>    <span class="keywordflow">for</span>(i=0;i&lt;n;i++)</div>
<div class="line"><span class="lineno">  676</span>    {</div>
<div class="line"><span class="lineno">  677</span>        error=<a class="code hl_function" href="i2c-std_8c.html#a020e948eaa99407ff2ffead770cbe3f2">i2c_write_byte_std</a>(I2CX,buf[i]);</div>
<div class="line"><span class="lineno">  678</span>        <span class="keywordflow">if</span>(error) </div>
<div class="line"><span class="lineno">  679</span>          <span class="keywordflow">return</span> error;</div>
<div class="line"><span class="lineno">  680</span>    }</div>
<div class="line"><span class="lineno">  681</span>    <span class="comment">// no error detected just return 0</span></div>
<div class="line"><span class="lineno">  682</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="i2c-std_8h.html#ac8daa3f8c12741492c20cf528dbb2019aeceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>;</div>
<div class="line"><span class="lineno">  683</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="i2c-std_8h_source.html#l00060">I2C_OK</a>, and <a class="el" href="i2c-std_8c_source.html#l00653">i2c_write_byte_std()</a>.</p>

<p class="reference">Referenced by <a class="el" href="i2c-std_8c_source.html#l01124">i2c_write_7bit_base_nbyte_std()</a>, and <a class="el" href="i2c-std_8c_source.html#l00990">i2c_write_7bit_nbyte_std()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="afe83ed5d7df372f9dcd44526309ef239" name="afe83ed5d7df372f9dcd44526309ef239"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe83ed5d7df372f9dcd44526309ef239">&#9670;&#160;</a></span>I2Cx_Timeout</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint32_t I2Cx_Timeout =<a class="el" href="i2c-std_8h.html#ab0176c4da537dd1a02b4828483da1e0e">I2C_MAX_BUSY_TIME</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="i2c-std_8c_source.html#l00051">51</a> of file <a class="el" href="i2c-std_8c_source.html">i2c-std.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="i2c-com_8c_source.html#l00581">i2c_read7_v1()</a>, <a class="el" href="i2c-std_8c_source.html#l00077">i2c_ready_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00353">i2c_wait_7bit_slave_address_rd_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00278">i2c_wait_7bit_slave_address_wr_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00537">i2c_wait_read_byte_btf_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00497">i2c_wait_read_byte_rxne_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00129">i2c_wait_start_event_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00183">i2c_wait_stop_event_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00398">i2c_wait_write_byte_btf_std()</a>, <a class="el" href="i2c-std_8c_source.html#l00444">i2c_wait_write_byte_txe_std()</a>, and <a class="el" href="i2c-com_8c_source.html#l00538">i2c_write7_v1()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_4c25b4c2861b8c1e9e0cda0ff69bb2a5.html">i2c</a></li><li class="navelem"><a class="el" href="i2c-std_8c.html">i2c-std.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
